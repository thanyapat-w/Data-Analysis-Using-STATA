-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   4 Jun 2021, 19:59:19

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(note: file D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log not found)
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. *************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /*******************************************\
>          Label and rename financial data variables      
>         \*******************************************/   
. 
end of do-file

. label variable Identifier "Identifier (RIC)"

. label variable FiscalYear "Fiscal Year"

. label variable Name "Company Name"

. label variable Country "Country of Headquarters"

. label variable Sector "TRBC Economic Sector Name"

. label variable CashShortTerm "Cash and Short Term Investments"

. label variable ARNet "Accounts Receivable - Trade, Net"

. label variable ARGross "Accounts Receivable - Trade, Gross"

. label variable PDA "Provision for Doubtful Accounts"

. label variable TotalReceivablesNet "Total Receivables, Net"

. label variable TotalInventory "Total Inventory"

. label variable PrepaidExpenses "Prepaid Expenses"

. label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

. label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

. label variable BuildingGross "Building - Gross"

. label variable LandGross "Land/Improvements - Gross"

. label variable MachineryGross "Machinery/Equipment - Gross"

. label variable ConstructionGross "Construction in Progress - Gross"

. label variable LeasesGross "Leases - Gross"

. label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

. label variable OtherPPENet "Other Property, Plant, Equipment - Net"

. label variable ADTotal "Accumulated Depreciation, Total"

. label variable GoodwillNet "Goodwill, Net"

. label variable GoodwillGross "Goodwill - Gross"

. label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

. label variable IntangiblesNet "Intangibles, Net"

. label variable IntangiblesGross "Intangibles, Gross"

. label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

. label variable NoteReceivableLongTerm "Note Receivable - Long Term"

. label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

. label variable TotalAssetsReported "Total Assets, Reported"

. label variable TotalDebt "Total Debt"

. label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

. label variable TotalLiabilities "Total Liabilities"

. label variable NetIncomeAfterTaxes "Net Income After Taxes"

. label variable BookValuePershare "Book Value Per Share"

. label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

. label variable CompanyMarketCap "Company Market Cap"

. label variable TotalEquity "Total Equity"

. label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

. label variable BoardSize "Board Size"

. label variable BoardAttendance "Board Attendance"

. label variable BoardStructureType "Board Structure Type"

. label variable BoardBackgroundandSkills "Board Background and Skills"

. label variable BoardGenderDiversityPercent "Board Gender Diversity"

. rename BoardGenderDiversityPercent BoardGenderDiversity

. label variable BoardSpecificSkillsPercent "Board Specific Skills"

. rename BoardSpecificSkillsPercent BoardSpecificSkills

. label variable BoardMemberAffiliations "Board Member Affiliations"

. label variable BoardIndividualReelection "Board Individual Re-election"

. label variable BoardMemberMembershipLimits "Board Member Membership Limits"

. label variable BoardMemberTermDuration "Board Member Term Duration"

. label variable BoardMemberCompensationUSD "Board Member Compensation"

. label variable FemaleonBoard "Female on Board"

. label variable NumberofBoardMeetings "Number of Board Meetings"

. label variable AverageBoardTenure "Average Board Tenure"

. label variable NonExecutiveBoardMembers "Non-Executive Board Members"

. label variable IndependentBoardMembers "Independent Board Members"

. label variable CEOBoardMember "CEO Board Member"

. label variable CEOChairmanSeparation "CEO-Chairman Separation"

. label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return (TSR)"

. label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

. label variable CEOChairmanSeparation "1 = CEO is the chairman"

. label variable CEOBoardMember "1 = The CEO is a board member"

. do "C:\Users\GL\AppData\Local\Temp\STD1c90_000000.tmp"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Manage variables
>                                         - Label and rename existing variables
>                                         - Generate varibles and add Label use for regression
> \********************************************************************************************************************/
. 
. clear

. capture log close
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   4 Jun 2021, 20:36:18

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. *************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
(note: file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta not found)
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,070           0.00
     FiscalYear |           0        150,070           0.00
           Name |           0        150,070           0.00
        Country |           0        150,070           0.00
         Sector |           0        150,070           0.00
   CashShortT~m |      59,736        150,070          39.81
          ARNet |      74,798        150,070          49.84
        ARGross |     111,329        150,070          74.18
            PDA |     111,139        150,070          74.06
   TotalRecei~t |      68,674        150,070          45.76
   TotalInven~y |      91,948        150,070          61.27
   PrepaidExp~s |      89,030        150,070          59.33
   OtherCurre~l |     101,375        150,070          67.55
   PPETotalGr~s |      82,975        150,070          55.29
   BuildingGr~s |     110,719        150,070          73.78
      LandGross |     112,784        150,070          75.15
   MachineryG~s |      95,605        150,070          63.71
   Constructi~s |     121,090        150,070          80.69
    LeasesGross |     148,721        150,070          99.10
   OtherPPEGr~s |     100,584        150,070          67.02
    OtherPPENet |     119,720        150,070          79.78
        ADTotal |      83,854        150,070          55.88
    GoodwillNet |     102,164        150,070          68.08
   GoodwillGr~s |     137,121        150,070          91.37
   AccuGoodwi~n |     137,405        150,070          91.56
   Intangible~t |      81,647        150,070          54.41
   Intangible~s |     104,091        150,070          69.36
   AccuIntang~n |     104,663        150,070          69.74
   NoteReceiv~m |     124,995        150,070          83.29
   OtherLongT~l |      76,440        150,070          50.94
   TotalAsset~d |      50,175        150,070          33.43
      TotalDebt |      50,758        150,070          33.82
   DeferredIn~y |     106,037        150,070          70.66
   TotalLiabi~s |      50,597        150,070          33.72
   NetIncomeA~s |      49,708        150,070          33.12
   BookValueP~e |      52,198        150,070          34.78
   BookValueP~y |      51,116        150,070          34.06
   CompanyMar~p |      37,030        150,070          24.68
    TotalEquity |      50,232        150,070          33.47
   TotalDebtT~y |      66,047        150,070          44.01
      BoardSize |     129,812        150,070          86.50
   BoardAtten~e |     129,788        150,070          86.48
   BoardStruc~e |     129,946        150,070          86.59
   BoardBackg~s |     129,788        150,070          86.48
   BoardGende~y |     129,815        150,070          86.50
   BoardSpeci~s |     130,452        150,070          86.93
   BoardMemb~ns |     129,823        150,070          86.51
   BoardIndiv~n |     129,788        150,070          86.48
   BoardMemb~ts |     131,929        150,070          87.91
   BoardMembe~n |     130,239        150,070          86.79
   BoardMembe~D |     130,869        150,070          87.21
   FemaleonBo~d |     129,815        150,070          86.50
   NumberofBo~s |     131,295        150,070          87.49
   AverageBoa~e |     130,150        150,070          86.73
   NonExecuti~s |     129,816        150,070          86.50
   Independen~s |     129,829        150,070          86.51
   CEOBoardMe~r |     130,673        150,070          87.07
   CEOChairma~n |     129,788        150,070          86.48
   CEOCompens~R |     129,787        150,070          86.48
   Chairmanis~O |     129,787        150,070          86.48
----------------+-----------------------------------------------

. 
end of do-file

. rename TotalAssetsReported TotalAssets

. do "C:\Users\GL\AppData\Local\Temp\STD1c90_000000.tmp"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Manage variables
>                                         - Label and rename existing variables
>                                         - Generate varibles and add Label use for regression
> \********************************************************************************************************************/
. 
. clear

. capture log close
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   4 Jun 2021, 20:42:28

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. *************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,070           0.00
     FiscalYear |           0        150,070           0.00
           Name |           0        150,070           0.00
        Country |           0        150,070           0.00
         Sector |           0        150,070           0.00
   CashShortT~m |      59,736        150,070          39.81
          ARNet |      74,798        150,070          49.84
        ARGross |     111,329        150,070          74.18
            PDA |     111,139        150,070          74.06
   TotalRecei~t |      68,674        150,070          45.76
   TotalInven~y |      91,948        150,070          61.27
   PrepaidExp~s |      89,030        150,070          59.33
   OtherCurre~l |     101,375        150,070          67.55
   PPETotalGr~s |      82,975        150,070          55.29
   BuildingGr~s |     110,719        150,070          73.78
      LandGross |     112,784        150,070          75.15
   MachineryG~s |      95,605        150,070          63.71
   Constructi~s |     121,090        150,070          80.69
    LeasesGross |     148,721        150,070          99.10
   OtherPPEGr~s |     100,584        150,070          67.02
    OtherPPENet |     119,720        150,070          79.78
        ADTotal |      83,854        150,070          55.88
    GoodwillNet |     102,164        150,070          68.08
   GoodwillGr~s |     137,121        150,070          91.37
   AccuGoodwi~n |     137,405        150,070          91.56
   Intangible~t |      81,647        150,070          54.41
   Intangible~s |     104,091        150,070          69.36
   AccuIntang~n |     104,663        150,070          69.74
   NoteReceiv~m |     124,995        150,070          83.29
   OtherLongT~l |      76,440        150,070          50.94
    TotalAssets |      50,175        150,070          33.43
      TotalDebt |      50,758        150,070          33.82
   DeferredIn~y |     106,037        150,070          70.66
   TotalLiabi~s |      50,597        150,070          33.72
   NetIncomeA~s |      49,708        150,070          33.12
   BookValueP~e |      52,198        150,070          34.78
   BookValueP~y |      51,116        150,070          34.06
   CompanyMar~p |      37,030        150,070          24.68
    TotalEquity |      50,232        150,070          33.47
   TotalDebtT~y |      66,047        150,070          44.01
      BoardSize |     129,812        150,070          86.50
   BoardAtten~e |     129,788        150,070          86.48
   BoardStruc~e |     129,946        150,070          86.59
   BoardBackg~s |     129,788        150,070          86.48
   BoardGende~y |     129,815        150,070          86.50
   BoardSpeci~s |     130,452        150,070          86.93
   BoardMemb~ns |     129,823        150,070          86.51
   BoardIndiv~n |     129,788        150,070          86.48
   BoardMemb~ts |     131,929        150,070          87.91
   BoardMembe~n |     130,239        150,070          86.79
   BoardMembe~D |     130,869        150,070          87.21
   FemaleonBo~d |     129,815        150,070          86.50
   NumberofBo~s |     131,295        150,070          87.49
   AverageBoa~e |     130,150        150,070          86.73
   NonExecuti~s |     129,816        150,070          86.50
   Independen~s |     129,829        150,070          86.51
   CEOBoardMe~r |     130,673        150,070          87.07
   CEOChairma~n |     129,788        150,070          86.48
   CEOCompens~R |     129,787        150,070          86.48
   Chairmanis~O |     129,787        150,070          86.48
----------------+-----------------------------------------------

.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,079 observations deleted)

.                                 *Drop MarketCap if MarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(9,542 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(167 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(48,212 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

. 
end of do-file

. do "D:\Master Thesis\202106_DataAnalysis\202106_DO_File\202106_2_Append.do"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : This do file will append(combine) all industrial in to one file
>                                  By the way, I will separate it into two file: EU_US_Dataset_202106
> \********************************************************************************************************************/
. 
. clear

. capture log close
---------------------------------------------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   5 Jun 2021, 16:25:27

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. *************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
(note: file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta not found)
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

. 
end of do-file

. do "C:\Users\GL\AppData\Local\Temp\STD2278_000000.tmp"

.         clear

. 
end of do-file

.  do "C:\Users\GL\AppData\Local\Temp\STD2278_000000.tmp"

.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

. 
end of do-file

. do "C:\Users\GL\AppData\Local\Temp\STD2278_000000.tmp"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Manage variables
>                                         - Label and rename existing variables
>                                         - Generate varibles and add Label use for regression
> \********************************************************************************************************************/
. 
. clear

. capture log close
---------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   5 Jun 2021, 16:45:33

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. *************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return (T
> SR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop by 
> using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a neg
> ative figure
.                         drop if PDA > 0
(111,150 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra accoun
> t to assets, it is always a negative figure.
.                         drop if ADTotal > 0
(2,597 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a co
> ntra account to assets, it is always a negative figure. 
.                         drop if AccuGoodwillAmortization > 0
(27,901 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated Inta
> ngible Amortization [AAMT] is always a negative figure.
.                         drop if AccuIntangibleAmortization
(8,373 observations deleted)

. 
end of do-file

. sum

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
  Identifier |          0
  FiscalYear |         19    2013.895    2.258188       2011       2019
        Name |          0
     Country |          0
      Sector |          0
-------------+---------------------------------------------------------
CashShortT~m |         19    3.45e+07    1.11e+08          0   4.85e+08
       ARNet |         19    1.55e+07    3.19e+07   26388.01   1.22e+08
     ARGross |         19    1.55e+07    3.30e+07   26388.01   1.26e+08
         PDA |         19    -1014559     2606623  -1.10e+07          0
TotalRecei~t |         19    1.74e+07    3.31e+07      27000   1.22e+08
-------------+---------------------------------------------------------
TotalInven~y |         14     3344378     4967274      37000   1.60e+07
PrepaidExp~s |         13     1486208     2441967   3958.201    7563479
OtherCurre~l |         11     3431792     6951159          0   2.40e+07
PPETotalGr~s |         19    6.71e+07    1.66e+08          0   6.49e+08
BuildingGr~s |          4    1.86e+07    3.70e+07          0   7.41e+07
-------------+---------------------------------------------------------
   LandGross |          4     1832357     2492746          0    5512538
MachineryG~s |         12    8.70e+07    2.05e+08   4472.558   6.49e+08
Constructi~s |          7     1228569     2508708          0    6899000
 LeasesGross |          0
OtherPPEGr~s |         11    1.27e+07    2.16e+07          0   5.69e+07
-------------+---------------------------------------------------------
 OtherPPENet |          1        1086           .       1086       1086
 PPETotalNet |         19    3.94e+07    9.92e+07          0   4.11e+08
     ADTotal |         19   -2.77e+07    7.35e+07  -2.38e+08          0
 GoodwillNet |         19    2.00e+08    7.91e+08          0   3.46e+09
GoodwillGr~s |         18    2.15e+08    8.12e+08          0   3.46e+09
-------------+---------------------------------------------------------
AccuGoodwi~n |         19    -3135094     4644333  -1.41e+07          0
Intangible~t |         19    1.55e+08    6.27e+08          0   2.74e+09
Intangible~s |         19    1.55e+08    6.27e+08          0   2.74e+09
AccuIntang~n |         19           0           0          0          0
NoteReceiv~m |          9     3638319     6819103   19306.54   1.95e+07
-------------+---------------------------------------------------------
OtherLongT~l |         13     2564307     5574731          0   1.90e+07
 TotalAssets |         19    4.66e+08    1.61e+09      82000   7.09e+09
   TotalDebt |         19    6.85e+07    1.33e+08          0   3.99e+08
DeferredIn~y |          9    1.01e+08    2.82e+08          0   8.53e+08
TotalLiabi~s |         19    3.81e+08    1.34e+09   285333.9   5.88e+09
-------------+---------------------------------------------------------
NetIncomeA~s |         19    -9182993    2.88e+07  -1.16e+08   2.70e+07
BookValueP~e |         17    19601.54    79654.84  -.0281258     328680
BookValueP~y |         19    7844.669    33227.49  -.7430605   145005.9
CompanyMar~p |         15    2.24e+07    4.49e+07        555   1.68e+08
 TotalEquity |         19    8.50e+07    2.76e+08  -2.41e+07   1.21e+09
-------------+---------------------------------------------------------
TotalDebtT~y |         17    1.105954    2.844311          0   11.81467
   BoardSize |          0
BoardAtten~e |          0
BoardStruc~e |          0
BoardBackg~s |          0
-------------+---------------------------------------------------------
BoardGende~y |          0
BoardSpeci~s |          0
BoardMemb~ns |          0
BoardIndiv~n |          0
BoardMemb~ts |          0
-------------+---------------------------------------------------------
BoardMembe~n |          0
BoardMembe~D |          0
FemaleonBo~d |          0
NumberofBo~s |          0
AverageBoa~e |          0
-------------+---------------------------------------------------------
NonExecuti~s |          0
Independen~s |          0
CEOBoardMe~r |          0
CEOChairma~n |          0
CEOCompens~R |          0
-------------+---------------------------------------------------------
Chairmanis~O |          0

. do "C:\Users\GL\AppData\Local\Temp\STD2278_000000.tmp"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Manage variables
>                                         - Label and rename existing variables
>                                         - Generate varibles and add Label use for regression
> \********************************************************************************************************************/
. 
. clear

. capture log close
---------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   5 Jun 2021, 16:46:28

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. *************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return (T
> SR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop by 
> using
. 
end of do-file

. do "C:\Users\GL\AppData\Local\Temp\STD2278_000000.tmp"

.                         drop if PDA > 0
(111,150 observations deleted)

. 
end of do-file

. do "C:\Users\GL\AppData\Local\Temp\STD2278_000000.tmp"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Manage variables
>                                         - Label and rename existing variables
>                                         - Generate varibles and add Label use for regression
> \********************************************************************************************************************/
. 
. clear

. capture log close
---------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   5 Jun 2021, 16:51:29

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. *************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return (T
> SR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop by 
> using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a neg
> ative figure
.                         drop if PDA > 0, missing
options not allowed
r(101);

end of do-file

r(101);

. do "C:\Users\GL\AppData\Local\Temp\STD2278_000000.tmp"

.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

. 
end of do-file

. sum

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
  Identifier |          0
  FiscalYear |    150,040      2015.5    2.872291       2011       2020
        Name |          0
     Country |          0
      Sector |          0
-------------+---------------------------------------------------------
CashShortT~m |     90,302    3.62e+08    2.91e+09   -2494670   1.56e+11
       ARNet |     75,245    3.53e+08    2.06e+09  -1.80e+08   1.21e+11
     ARGross |     38,716    5.11e+08    2.14e+09  -1123.103   6.88e+10
         PDA |     38,906   -2.72e+07    1.96e+08  -1.69e+10   1.08e+09
TotalRecei~t |     81,367    4.39e+08    3.04e+09  -6.37e+09   3.08e+11
-------------+---------------------------------------------------------
TotalInven~y |     58,108    3.29e+08    1.75e+09  -6.11e+07   8.17e+10
PrepaidExp~s |     61,007    3.09e+07    2.03e+08  -3.01e+09   2.09e+10
OtherCurre~l |     48,679    2.06e+08    3.16e+09  -2.14e+09   2.61e+11
PPETotalGr~s |     67,066    2.22e+09    1.40e+10     -42000   5.11e+11
BuildingGr~s |     39,328    4.04e+08    2.33e+09   -2858207   1.06e+11
-------------+---------------------------------------------------------
   LandGross |     37,269    3.15e+08    1.82e+09  -887599.5   7.76e+10
MachineryG~s |     54,440    1.36e+09    1.01e+10   -9805784   4.87e+11
Constructi~s |     28,963    1.88e+08    1.13e+09  -2.19e+07   4.24e+10
 LeasesGross |      1,349    1.77e+09    8.20e+09          0   8.20e+10
OtherPPEGr~s |     49,457    5.54e+08    5.84e+09  -7.24e+08   3.45e+11
-------------+---------------------------------------------------------
 OtherPPENet |     30,347    2.50e+08    7.50e+09  -2.07e+09   1.25e+12
 PPETotalNet |     89,224    9.29e+08    6.36e+09    -316470   2.60e+11
     ADTotal |     66,187   -1.11e+09    8.75e+09  -1.25e+12   1.07e+09
 GoodwillNet |     47,879    1.02e+09    4.55e+09  -6.47e+07   1.46e+11
GoodwillGr~s |     12,942    1.13e+09    4.68e+09  -148867.3   1.41e+11
-------------+---------------------------------------------------------
AccuGoodwi~n |     12,658   -1.98e+08    1.23e+09  -2.60e+10   1.67e+08
Intangible~t |     68,399    4.36e+08    3.19e+09  -4.67e+08   1.64e+11
Intangible~s |     45,954    9.17e+08    5.13e+09  -2.29e+07   1.83e+11
AccuIntang~n |     45,383   -3.45e+08    1.93e+09  -6.60e+10   7.81e+07
NoteReceiv~m |     25,071    1.74e+09    6.32e+10  -8.00e+07   3.66e+12
-------------+---------------------------------------------------------
OtherLongT~l |     73,600    2.95e+08    2.94e+09  -5.96e+09   3.36e+11
 TotalAssets |     99,863    8.50e+09    8.45e+10          0   3.99e+12
   TotalDebt |     99,282    2.23e+09    4.24e+10    -303580   3.94e+12
DeferredIn~y |     44,007    2.94e+08    1.83e+09  -1.31e+08   7.65e+10
TotalLiabi~s |     99,440    7.13e+09    7.92e+10  -6.96e+07   3.96e+12
-------------+---------------------------------------------------------
NetIncomeA~s |    100,332    1.45e+08    1.26e+09  -2.33e+10   8.40e+10
BookValueP~e |     97,840    1469.933    162113.2   -2207052   2.61e+07
BookValueP~y |     98,923    2149.652    219856.1   -5514608   2.67e+07
CompanyMar~p |    113,011    2.84e+09    2.12e+10    .000204   2.23e+12
 TotalEquity |     99,806    1.38e+09    8.61e+09  -2.29e+10   4.43e+11
-------------+---------------------------------------------------------
TotalDebtT~y |     83,993     2.01155    105.7502  -.1258631   26369.19
   BoardSize |     20,246    10.19283    3.398307          1         38
BoardAtten~e |     20,270    .1059201    .3077429          0          1
BoardStruc~e |          0
BoardBackg~s |     20,270    .9673902    .1776174          0          1
-------------+---------------------------------------------------------
BoardGende~y |     20,243    19.56578    12.58643          0        100
BoardSpeci~s |     19,607    49.96505    22.45308          0        100
BoardMemb~ns |     20,235    .8010063    .6917942          0   19.33333
BoardIndiv~n |     20,270    .5429206    .4981667          0          1
BoardMemb~ts |     18,130    950.1499    214.1242          1        999
-------------+---------------------------------------------------------
BoardMembe~n |     19,820    2.174622     1.26236          1          6
BoardMembe~D |     19,190     2084409    1.65e+07          0   1.93e+09
FemaleonBo~d |     20,243    19.56578    12.58643          0        100
NumberofBo~s |     18,764    8.568749    4.493218          0         91
AverageBoa~e |     19,908    8.105133    4.034958          0    38.9375
-------------+---------------------------------------------------------
NonExecuti~s |     20,242    83.07871    11.26063          0        100
Independen~s |     20,229    71.30928    21.74449          0        100
CEOBoardMe~r |     19,385    .8596337    .3473756          0          1
CEOChairma~n |     20,270    .4933399     .499968          0          1
CEOCompens~R |     20,271     .470919    .4991659          0          1
-------------+---------------------------------------------------------
Chairmanis~O |     20,271    .4425534    .4967012          0          1

. sum ADTotal if ADTotal > 0

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
     ADTotal |         13    8.34e+07    2.98e+08   78.34621   1.07e+09

. sum PDA if PDA > 0

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         PDA |         16    6.98e+07    2.70e+08       9000   1.08e+09

. do "C:\Users\GL\AppData\Local\Temp\STD2278_000000.tmp"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Manage variables
>                                         - Label and rename existing variables
>                                         - Generate varibles and add Label use for regression
> \********************************************************************************************************************/
. 
. clear

. capture log close
---------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   5 Jun 2021, 16:57:56

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. *************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return (T
> SR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop by 
> using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a neg
> ative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

. 
end of do-file

. sum

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
  Identifier |          0
  FiscalYear |    148,604    2015.496    2.871843       2011       2020
        Name |          0
     Country |          0
      Sector |          0
-------------+---------------------------------------------------------
CashShortT~m |     88,868    3.67e+08    2.93e+09   -2494670   1.56e+11
       ARNet |     73,809    3.59e+08    2.08e+09  -1.80e+08   1.21e+11
     ARGross |     37,353    5.28e+08    2.18e+09  -1123.103   6.88e+10
         PDA |     37,470   -2.83e+07    1.99e+08  -1.69e+10        -30
TotalRecei~t |     79,931    4.46e+08    3.06e+09  -6.37e+09   3.08e+11
-------------+---------------------------------------------------------
TotalInven~y |     57,188    3.34e+08    1.76e+09          0   8.17e+10
PrepaidExp~s |     59,862    3.14e+07    2.05e+08  -3.01e+09   2.09e+10
OtherCurre~l |     47,853    2.09e+08    3.18e+09  -2.14e+09   2.61e+11
PPETotalGr~s |     65,795    2.26e+09    1.41e+10     -42000   5.11e+11
BuildingGr~s |     38,657    4.10e+08    2.35e+09   -2858207   1.06e+11
-------------+---------------------------------------------------------
   LandGross |     36,885    3.18e+08    1.83e+09  -887599.5   7.76e+10
MachineryG~s |     53,378    1.38e+09    1.02e+10   -9805784   4.87e+11
Constructi~s |     28,568    1.90e+08    1.14e+09  -2.19e+07   4.24e+10
 LeasesGross |      1,325    1.79e+09    8.27e+09          0   8.20e+10
OtherPPEGr~s |     48,562    5.64e+08    5.89e+09  -7.24e+08   3.45e+11
-------------+---------------------------------------------------------
 OtherPPENet |     30,060    2.53e+08    7.53e+09  -2.07e+09   1.25e+12
 PPETotalNet |     87,846    9.41e+08    6.41e+09    -316470   2.60e+11
     ADTotal |     64,918   -1.13e+09    8.83e+09  -1.25e+12   1.07e+09
 GoodwillNet |     47,390    1.03e+09    4.57e+09  -6.47e+07   1.46e+11
GoodwillGr~s |     12,790    1.15e+09    4.71e+09  -148867.3   1.41e+11
-------------+---------------------------------------------------------
AccuGoodwi~n |     12,508   -2.01e+08    1.24e+09  -2.60e+10   1.67e+08
Intangible~t |     67,396    4.42e+08    3.21e+09  -4.67e+08   1.64e+11
Intangible~s |     45,116    9.34e+08    5.18e+09  -2.29e+07   1.83e+11
AccuIntang~n |     44,552   -3.51e+08    1.95e+09  -6.60e+10   7.81e+07
NoteReceiv~m |     24,773    1.76e+09    6.36e+10  -8.00e+07   3.66e+12
-------------+---------------------------------------------------------
OtherLongT~l |     72,517    2.99e+08    2.96e+09  -5.96e+09   3.36e+11
 TotalAssets |     98,427    8.62e+09    8.51e+10          0   3.99e+12
   TotalDebt |     97,847    2.26e+09    4.27e+10    -303580   3.94e+12
DeferredIn~y |     43,609    2.96e+08    1.84e+09  -1.31e+08   7.65e+10
TotalLiabi~s |     98,004    7.24e+09    7.98e+10  -6.96e+07   3.96e+12
-------------+---------------------------------------------------------
NetIncomeA~s |     98,898    1.47e+08    1.27e+09  -2.33e+10   8.40e+10
BookValueP~e |     96,430    1497.228    163235.7   -2207052   2.61e+07
BookValueP~y |     97,491    2193.408    221427.2   -5514608   2.67e+07
CompanyMar~p |    111,747    2.87e+09    2.13e+10    .000204   2.23e+12
 TotalEquity |     98,370    1.40e+09    8.67e+09  -2.29e+10   4.43e+11
-------------+---------------------------------------------------------
TotalDebtT~y |     82,871    1.998263    106.1952  -.1258631   26369.19
   BoardSize |     20,134    10.20483    3.398114          1         38
BoardAtten~e |     20,158    .1060125    .3078613          0          1
BoardStruc~e |          0
BoardBackg~s |     20,158    .9673579    .1777025          0          1
-------------+---------------------------------------------------------
BoardGende~y |     20,131    19.57217     12.5768          0        100
BoardSpeci~s |     19,504    49.93619    22.44347          0        100
BoardMemb~ns |     20,123     .799646    .6866952          0   19.33333
BoardIndiv~n |     20,158    .5424149    .4982101          0          1
BoardMemb~ts |     18,024    949.9723    214.4923          1        999
-------------+---------------------------------------------------------
BoardMembe~n |     19,710     2.17585    1.262866          1          6
BoardMembe~D |     19,080     2087310    1.65e+07          0   1.93e+09
FemaleonBo~d |     20,131    19.57217     12.5768          0        100
NumberofBo~s |     18,658    8.559921    4.468668          0         91
AverageBoa~e |     19,797    8.110122     4.03511          0    38.9375
-------------+---------------------------------------------------------
NonExecuti~s |     20,130    83.10375    11.25288          0        100
Independen~s |     20,119    71.28507    21.76791          0        100
CEOBoardMe~r |     19,273    .8598558    .3471456          0          1
CEOChairma~n |     20,158    .4935509    .4999708          0          1
CEOCompens~R |     20,159    .4715512    .4992024          0          1
-------------+---------------------------------------------------------
Chairmanis~O |     20,159    .4425319    .4966988          0          1

. do "C:\Users\GL\AppData\Local\Temp\STD2278_000000.tmp"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Manage variables
>                                         - Label and rename existing variables
>                                         - Generate varibles and add Label use for regression
> \********************************************************************************************************************/
. 
. clear

. capture log close
---------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   5 Jun 2021, 16:59:58

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. *************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return (T
> SR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop by 
> using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a neg
> ative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra accoun
> t to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a co
> ntra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated Inta
> ngible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

. 
end of do-file

. do "C:\Users\GL\AppData\Local\Temp\STD2278_000000.tmp"

.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop by 
> using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a neg
> ative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra accoun
> t to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a co
> ntra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated Inta
> ngible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a missi
> ng value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total asse
> t use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity use
>  as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiability)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / Tota
> lAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

. 
end of do-file

. do "C:\Users\GL\AppData\Local\Temp\STD2278_000000.tmp"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Manage variables
>                                         - Label and rename existing variables
>                                         - Generate varibles and add Label use for regression
> \********************************************************************************************************************/
. 
. clear

. capture log close
---------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   5 Jun 2021, 17:29:12

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. *************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return (T
> SR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop by 
> using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a neg
> ative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra accoun
> t to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a co
> ntra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated Inta
> ngible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a missi
> ng value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total asse
> t use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity use
>  as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiability)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / Tota
> lAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gros
> s - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + Pr
> epaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm + Oth
> erLongTermAssetsTotal

.                         *CRER using total assets net
.                                 gen CRER1 = CRE / TotalAssets

.                         *CRER using total assets gross
.                                 gen CRER2 = CRE / TotalAssetGross

.                 
.         /*****************\
>          Control Variables
>         \*****************
>                 *1.Control for firm size
>                         gen Firm_Size = log(TotalAssets)
>                 *2.Control for firm leverage
>                         *I will drop missing TotalDebt
>                                 drop if TotalDebt == .
>                         gen Firm_Leverage = TotalDebt/TotalEquity
>                 *3.Control for ROA
>                         *ROA download directly from datastream have too much missing value therefore, I will drop it
>                         drop ROA
>                         *I will drop missing NetIncome
>                                 drop if NetIncome == .
>                         *Then I will generate new ROA
>                         gen ROA = NetIncome/TotalAssets
>                         
>         /*****************\
>          Others variables
>         \*****************/
>                 *Create sector of industries as int by change sector from string to int
>                         egen Indus = group(TRBCEconomicSector)
>                 *Create Unique FirmID as int by change FirmID from String int
>                         egen FirmID = group(IdentifierRIC CompanyName TRBCEconomicSector)
>                 *Create NumFirm to measure how many firm in each industries
>                         *use _n to see how many data of that firm in each year
>                         bysort FirmID: gen NumFirm = _n
>                 *Create region dummy
>                         gen Region = 0
>                         replace Region = 1 if CountryofHeadquarters != "United States of America"
>         
> /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
>         /****************\
>          Board variables
>         \****************/
>                 drop if ChairmanisexCEO == .
>                 drop if CEOBoardMember == .
>         xtset FirmID FiscalYear
>         save "D:\Master Thesis\DataAnalysis_202105\5_ManageVariables\ManageVariables_DTA_File\EU_US_Clean_Dataset.dta", r
> eplace

end of do-file

. sum CRE CRER1 CRER2

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
         CRE |     39,527    6.08e+08    3.38e+09   119.5457   1.34e+11
       CRER1 |     39,527     .109142     .133163   2.46e-06   .9995008
       CRER2 |     39,527    .1443214    .1769601   2.16e-06          1

. do "C:\Users\GL\AppData\Local\Temp\STD2278_000000.tmp"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Manage variables
>                                         - Label and rename existing variables
>                                         - Generate varibles and add Label use for regression
> \********************************************************************************************************************/
. 
. clear

. capture log close
---------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   5 Jun 2021, 17:33:21

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. *************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return (T
> SR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop by 
> using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a neg
> ative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra accoun
> t to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a co
> ntra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated Inta
> ngible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a missi
> ng value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total asse
> t use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity use
>  as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiability)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / Tota
> lAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gros
> s - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + Pr
> epaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm + Oth
> erLongTermAssetsTotal

.                         *CRER using total assets net
.                                 gen CRER1 = CRE / TotalAssets

.                         *CRER using total assets gross
.                                 gen CRER2 = CRE / TotalAssetGross

.                 
.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *ROA download directly from datastream have too much missing value therefore, I will drop it
.                         drop ROA
variable ROA not found
r(111);

end of do-file

r(111);

. do "D:\Master Thesis\202106_DataAnalysis\202106_DO_File\202106_3_ManageVariables.do"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Manage variables
>                                         - Label and rename existing variables
>                                         - Generate varibles and add Label use for regression
> \********************************************************************************************************************/
. 
. clear

. capture log close
---------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   5 Jun 2021, 17:34:01

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. *************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return (T
> SR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop by 
> using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a neg
> ative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra accoun
> t to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a co
> ntra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated Inta
> ngible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a missi
> ng value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total asse
> t use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity use
>  as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiability)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / Tota
> lAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gros
> s - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + Pr
> epaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm + Oth
> erLongTermAssetsTotal

.                         *CRER using total assets net
.                                 gen CRER1 = CRE / TotalAssets

.                         *CRER using total assets gross
.                                 gen CRER2 = CRE / TotalAssetGross

.                 
.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(5 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

.                         
.         /*****************\
>          Others variables
>         \*****************/
.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Sector)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(13,890 real changes made)

.         
. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(25,142 observations deleted)

.                 drop if CEOBoardMember == .
(482 observations deleted)

.         xtset FirmID FiscalYear
       panel variable:  FirmID (unbalanced)
        time variable:  FiscalYear, 2011 to 2020, but with gaps
                delta:  1 unit

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

. 
end of do-file

. do "C:\Users\GL\AppData\Local\Temp\STD2278_000000.tmp"

.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0         13,888           0.00
     FiscalYear |           0         13,888           0.00
           Name |           0         13,888           0.00
        Country |           0         13,888           0.00
         Sector |           0         13,888           0.00
   CashShortT~m |           0         13,888           0.00
          ARNet |       2,070         13,888          14.90
        ARGross |           0         13,888           0.00
            PDA |       4,634         13,888          33.37
   TotalRecei~t |           0         13,888           0.00
   TotalInven~y |           0         13,888           0.00
   PrepaidExp~s |           0         13,888           0.00
   OtherCurre~l |           0         13,888           0.00
   PPETotalGr~s |           0         13,888           0.00
   BuildingGr~s |           0         13,888           0.00
      LandGross |           0         13,888           0.00
   MachineryG~s |           0         13,888           0.00
   Constructi~s |           0         13,888           0.00
    LeasesGross |           0         13,888           0.00
   OtherPPEGr~s |           0         13,888           0.00
    OtherPPENet |      12,916         13,888          93.00
    PPETotalNet |           0         13,888           0.00
        ADTotal |           0         13,888           0.00
    GoodwillNet |       1,723         13,888          12.41
   GoodwillGr~s |           0         13,888           0.00
   AccuGoodwi~n |      11,633         13,888          83.76
   Intangible~t |       1,521         13,888          10.95
   Intangible~s |           0         13,888           0.00
   AccuIntang~n |       2,736         13,888          19.70
   NoteReceiv~m |           0         13,888           0.00
   OtherLongT~l |           0         13,888           0.00
    TotalAssets |           0         13,888           0.00
      TotalDebt |           0         13,888           0.00
   DeferredIn~y |           0         13,888           0.00
   TotalLiabi~s |           0         13,888           0.00
   NetIncomeA~s |           0         13,888           0.00
   BookValueP~e |          26         13,888           0.19
   BookValueP~y |           0         13,888           0.00
   CompanyMar~p |           0         13,888           0.00
    TotalEquity |           0         13,888           0.00
   TotalDebtT~y |         542         13,888           3.90
      BoardSize |           0         13,888           0.00
   BoardAtten~e |           1         13,888           0.01
   BoardStruc~e |          99         13,888           0.71
   BoardBackg~s |           1         13,888           0.01
   BoardGende~y |           2         13,888           0.01
   BoardSpeci~s |         463         13,888           3.33
   BoardMemb~ns |           6         13,888           0.04
   BoardIndiv~n |           1         13,888           0.01
   BoardMemb~ts |       1,157         13,888           8.33
   BoardMembe~n |         245         13,888           1.76
   BoardMembe~D |         603         13,888           4.34
   FemaleonBo~d |           2         13,888           0.01
   NumberofBo~s |         795         13,888           5.72
   AverageBoa~e |         204         13,888           1.47
   NonExecuti~s |           2         13,888           0.01
   Independen~s |          11         13,888           0.08
   CEOBoardMe~r |           0         13,888           0.00
   CEOChairma~n |           1         13,888           0.01
   CEOCompens~R |           0         13,888           0.00
   Chairmanis~O |           0         13,888           0.00
         TobinQ |           0         13,888           0.00
             MB |           0         13,888           0.00
            CRE |           0         13,888           0.00
   TotalAsse~ss |           0         13,888           0.00
          CRER1 |           0         13,888           0.00
          CRER2 |           0         13,888           0.00
       FirmSize |           0         13,888           0.00
   FirmLeverage |           0         13,888           0.00
            ROA |           0         13,888           0.00
          Indus |           0         13,888           0.00
         FirmID |           0         13,888           0.00
        NumFirm |           0         13,888           0.00
         Region |           0         13,888           0.00
----------------+-----------------------------------------------

. 
end of do-file

. sum CRER1 CRER2

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       CRER1 |     13,888    .1007522    .1138859   .0000301   .9763525
       CRER2 |     13,888     .131067    .1502705   .0000235          1

. sort CRER2

. do "C:\Users\GL\AppData\Local\Temp\STD2278_000000.tmp"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Manage variables
>                                         - Label and rename existing variables
>                                         - Generate varibles and add Label use for regression
> \********************************************************************************************************************/
. 
. clear

. capture log close
---------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   5 Jun 2021, 17:38:28

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. *************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return (T
> SR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop by 
> using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a neg
> ative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra accoun
> t to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a co
> ntra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated Inta
> ngible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a missi
> ng value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total asse
> t use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity use
>  as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiability)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / Tota
> lAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gros
> s - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + Pr
> epaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm + Oth
> erLongTermAssetsTotal

.                         *CRER using total assets net
.                                 gen CRER1 = CRE / TotalAssets

.                         *CRER using total assets gross
.                                 gen CRER2 = CRE / TotalAssetGross

.                                 drop if CRER2 == 1
(4 observations deleted)

.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(5 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

.                         
.         /*****************\
>          Others variables
>         \*****************/
.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Sector)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(13,890 real changes made)

.         
. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(25,139 observations deleted)

.                 drop if CEOBoardMember == .
(482 observations deleted)

.         xtset FirmID FiscalYear
       panel variable:  FirmID (unbalanced)
        time variable:  FiscalYear, 2011 to 2020, but with gaps
                delta:  1 unit

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

. 
end of do-file

. sum CRER1 CRER2

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       CRER1 |     13,887    .1007559    .1138892   .0000301   .9763525
       CRER2 |     13,887    .1310044    .1500949   .0000235   .9282534

. do "C:\Users\GL\AppData\Local\Temp\STD2278_000000.tmp"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Manage variables
>                                         - Label and rename existing variables
>                                         - Generate varibles and add Label use for regression
> \********************************************************************************************************************/
. 
. clear

. capture log close
---------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   5 Jun 2021, 17:39:40

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. *************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return (T
> SR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop by 
> using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a neg
> ative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra accoun
> t to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a co
> ntra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated Inta
> ngible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a missi
> ng value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total asse
> t use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity use
>  as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiability)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / Tota
> lAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gros
> s - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + Pr
> epaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm + Oth
> erLongTermAssetsTotal

.                         *CRER using total assets net
.                                 gen CRER1 = CRE / TotalAssets

.                                 drop if CRER1 < 0.009
(5,673 observations deleted)

.                         *CRER using total assets gross
.                                 gen CRER2 = CRE / TotalAssetGross

.                                 drop if CRER2 == 1
(4 observations deleted)

.                                 drop if CRER2 < 0.009
(575 observations deleted)

.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(8 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(4 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

.                         
.         /*****************\
>          Others variables
>         \*****************/
.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Sector)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(11,808 real changes made)

.         
. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(20,654 observations deleted)

.                 drop if CEOBoardMember == .
(399 observations deleted)

.         xtset FirmID FiscalYear
       panel variable:  FirmID (unbalanced)
        time variable:  FiscalYear, 2011 to 2020, but with gaps
                delta:  1 unit

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

. 
end of do-file

. sum CRER1 CRER2

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       CRER1 |     12,210    .1138898    .1154229   .0090214   .9763525
       CRER2 |     12,210    .1369358    .1479341   .0090005   .9282534

. do "C:\Users\GL\AppData\Local\Temp\STD2278_000000.tmp"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Manage variables
>                                         - Label and rename existing variables
>                                         - Generate varibles and add Label use for regression
> \********************************************************************************************************************/
. 
. clear

. capture log close
-----------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_Ma
> nageVariables.log
  log type:  text
 opened on:   5 Jun 2021, 17:56:30

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_Fi
> le\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_Mana
> geVariablescmd.log opened)

. ***************************************************************************
> **********************************
. 
. /**************************************************************************
> *********************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \**************************************************************************
> *********************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EU
> S.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investmen
> ts"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Asset
> s, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment
> , Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress 
> - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipmen
> t - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipmen
> t - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment
> , Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwi
> ll Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Inta
> ngible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Lo
> ng Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term As
> sets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Incom
> e Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per
>  Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total 
> Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background a
> nd Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Di
> versity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific S
> kills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affili
> ations"

.                 label variable BoardIndividualReelection "Board Individual 
> Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Me
> mbership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term D
> uration"

.                 label variable BoardMemberCompensationUSD "Board Member Com
> pensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meeti
> ngs"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Boar
> d Members"

.                 label variable IndependentBoardMembers "Independent Board M
> embers"

.                 label variable CEOBoardMember "1 = The CEO is a board membe
> r"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairm
> an"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's comp
> ensation linked to total shareholder return (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in pr
> evious years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_E
> US_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.
> dta saved

.         clear

. /**************************************************************************
> *********************************\
>  Next I will create new variables use for regression
> \**************************************************************************
> *********************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EU
> S_dataset.dta"

.         *Before I go further I will check missing value in each variables a
> nd consider to replace some with 0 or drop by using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra
>  account to receivables and expressed in a negative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accu
> mulated Depreciation, Total as a contra account to assets, it is always a n
> egative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Ac
> cumulated Goodwill Amortization [AAGA] as a contra account to assets, it is
>  always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwill
> Amortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization a
> s a contra account to assets, Accumulated Intangible Amortization [AAMT] is
>  always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntang
> ibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calcula
> te missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/mod
> ules/missing-values/
.                                 *"Whenever you add, subtract, multiply, div
> ide, etc., values that involve missing a missing value, the result is missi
> ng."
.                         *Therefore, I will ged rid off missing value by dro
> p or replace it with "0"
.                                 *Since Total assets should not equal to "0"
>  or . 
.                                 *Therefore, I will drop if TotalAssets == .
>  | TotalAssets == 0 to avoid error (Total asset use as Denominator in many 
> equation)
.                                         drop if TotalAssets == . | TotalAss
> ets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | Com
> panyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | Tot
> alEquity == 0 to avoid error (Total equity use as denominator in MB and Lev
> erage)
.                                         drop if TotalEquity == . | TotalEqu
> ity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since De
> ferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiabilit
> y = 0 if missing(DeferredIncomeTaxLTLiability)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - Tota
> lEquity - DeferredIncomeTaxLTLiability) / TotalAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAsset
> s
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalA
> ssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varib
> les
.                                 replace BuildingGross = 0 if missing(Buildi
> ngGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(Machi
> neryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(Co
> nstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGr
> oss)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherP
> PEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_
> Gross - NaturalResources_Gross - OtherPPE_Gross - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + Const
> ructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashSh
> ortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(
> TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(Total
> Inventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(Prep
> aidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if miss
> ing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETot
> alGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(Goodwi
> llGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(Int
> angiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missi
> ng(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if mis
> sing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGro
> ss + TotalReceivablesNet + TotalInventory + PrepaidExpenses + OtherCurrentA
> ssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceiva
> bleLongTerm + OtherLongTermAssetsTotal

.                         *CRER using total assets net
.                                 gen CRER1 = CRE / TotalAssets

.                                 drop if CRER1 < 0.009
(5,673 observations deleted)

.                         *CRER using total assets gross
.                                 gen CRER2 = CRE / TotalAssetGross

.                                 drop if CRER2 == 1
(4 observations deleted)

.                                 drop if CRER2 < 0.009
(575 observations deleted)

.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(8 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(4 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

.                         
.         /*****************\
>          Others variables
>         \*****************/
.                 *Create sector of industries as int by change sector from s
> tring to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String i
> nt
.                         egen FirmID = group(Identifier Name Sector)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each y
> ear
.                         bysort FirmID: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of 
> America"
(11,808 real changes made)

.         
. /**************************************************************************
> *********************************\
>  Drop variables
> \**************************************************************************
> *********************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(20,654 observations deleted)

.                 drop if CEOBoardMember == .
(399 observations deleted)

.                 drop if Sector == "Academic & Educational Services "
(0 observations deleted)

.         xtset FirmID FiscalYear
       panel variable:  FirmID (unbalanced)
        time variable:  FiscalYear, 2011 to 2020, but with gaps
                delta:  1 unit

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_E
> US_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.
> dta saved

. 
end of do-file

. tab Sector

      TRBC Economic Sector Name |      Freq.     Percent        Cum.
--------------------------------+-----------------------------------
Academic & Educational Services |         67        0.55        0.55
                Basic Materials |        829        6.79        7.34
             Consumer Cyclicals |      2,214       18.13       25.47
         Consumer Non-Cyclicals |        937        7.67       33.14
                         Energy |        414        3.39       36.54
                     Financials |      1,307       10.70       47.24
                     Healthcare |      1,746       14.30       61.54
                    Industrials |      2,332       19.10       80.64
                     Technology |      1,983       16.24       96.88
                      Utilities |        381        3.12      100.00
--------------------------------+-----------------------------------
                          Total |     12,210      100.00

. sort Sector

. do "C:\Users\GL\AppData\Local\Temp\STD544_000000.tmp"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Manage variables
>                                         - Label and rename existing variables
>                                         - Generate varibles and add Label use for regression
> \********************************************************************************************************************/
. 
. clear

. capture log close
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   5 Jun 2021, 17:57:38

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. *************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a n
> egative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra acco
> unt to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a 
> contra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated In
> tangible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gr
> oss - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + 
> PrepaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm +
>  OtherLongTermAssetsTotal

.                         *CRER using total assets net
.                                 gen CRER1 = CRE / TotalAssets

.                                 drop if CRER1 < 0.009
(5,673 observations deleted)

.                         *CRER using total assets gross
.                                 gen CRER2 = CRE / TotalAssetGross

.                                 drop if CRER2 == 1
(4 observations deleted)

.                                 drop if CRER2 < 0.009
(575 observations deleted)

.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(8 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(4 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

.                         
.         /*****************\
>          Others variables
>         \*****************/
.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Sector)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(11,808 real changes made)

.         
. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(20,654 observations deleted)

.                 drop if CEOBoardMember == .
(399 observations deleted)

.                 drop if Sector == "Academic & Educational Services"
(67 observations deleted)

.         xtset FirmID FiscalYear
       panel variable:  FirmID (unbalanced)
        time variable:  FiscalYear, 2011 to 2020, but with gaps
                delta:  1 unit

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

. 
end of do-file

. tab Sector

      TRBC Economic Sector Name |      Freq.     Percent        Cum.
--------------------------------+-----------------------------------
                Basic Materials |        829        6.83        6.83
             Consumer Cyclicals |      2,214       18.23       25.06
         Consumer Non-Cyclicals |        937        7.72       32.78
                         Energy |        414        3.41       36.19
                     Financials |      1,307       10.76       46.95
                     Healthcare |      1,746       14.38       61.33
                    Industrials |      2,332       19.20       80.53
                     Technology |      1,983       16.33       96.86
                      Utilities |        381        3.14      100.00
--------------------------------+-----------------------------------
                          Total |     12,143      100.00

. do "D:\Master Thesis\202106_DataAnalysis\202106_DO_File\202106_4_SumObs.do"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Manage variables
>                                         - Label and rename existing variables
>                                         - Generate varibles and add Label use for regression
> \********************************************************************************************************************/
. 
. clear

. capture log close
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   5 Jun 2021, 18:12:07

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. *************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a n
> egative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra acco
> unt to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a 
> contra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated In
> tangible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gr
> oss - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + 
> PrepaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm +
>  OtherLongTermAssetsTotal

.                         *CRER using total assets gross
.                                 gen CRER = CRE / TotalAssetGross

.                                 drop if CRER == 1
(4 observations deleted)

.                                 drop if CRER < 0.009
(4,638 observations deleted)

.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(4 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

.                         
.         /*****************\
>          Others variables
>         \*****************/
.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Sector)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(12,306 real changes made)

.         
. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(21,477 observations deleted)

.                 drop if CEOBoardMember == .
(457 observations deleted)

.                 drop if Sector == "Academic & Educational Services"
(67 observations deleted)

.         xtset FirmID FiscalYear
       panel variable:  FirmID (unbalanced)
        time variable:  FiscalYear, 2011 to 2020, but with gaps
                delta:  1 unit

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

. 
end of do-file

. do "D:\Master Thesis\202106_DataAnalysis\202106_DO_File\202106_4_SumObs.do"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Summary Observations
> \********************************************************************************************************************/
. 
. clear

. capture log close
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   5 Jun 2021, 18:22:00

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. *************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a n
> egative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra acco
> unt to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a 
> contra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated In
> tangible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gr
> oss - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + 
> PrepaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm +
>  OtherLongTermAssetsTotal

.                         *CRER using total assets gross
.                                 gen CRER = CRE / TotalAssetGross

.                                 drop if CRER == 1
(4 observations deleted)

.                                 drop if CRER < 0.009
(4,638 observations deleted)

.                                 gen CRER1 = PPETotalNet/TotalAssets

.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(4 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

.                         
.         /*****************\
>          Others variables
>         \*****************/
.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Sector)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(12,306 real changes made)

.         
. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(21,477 observations deleted)

.                 drop if CEOBoardMember == .
(457 observations deleted)

.                 drop if Sector == "Academic & Educational Services"
(67 observations deleted)

.         xtset FirmID FiscalYear
       panel variable:  FirmID (unbalanced)
        time variable:  FiscalYear, 2011 to 2020, but with gaps
                delta:  1 unit

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

. 
end of do-file

. do "C:\Users\GL\AppData\Local\Temp\STD544_000000.tmp"

. use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         asdoc, row(\i, \i, \i, Overall, \i, \i, \i,  US, \i, \i, \i, EU, \i) title(Corporate real estate ownership rati
> os by industry and country), save(D:\Master Thesis\202106_DataAnalysis\202106_Table_Results\202106_5_CRER1distribution1
> .doc) replace
(note: file D:\Master Thesis\202106_DataAnalysis\202106_Table_Results\202106_5_CRER1distribution1.doc not found)
Click to Open File:  D:\Master Thesis\202106_DataAnalysis\202106_Table_Results\202106_5_CRER1distribution1.doc

.         asdoc, row(\i, Mean, SD, Min, Max, Mean, SD, Min, Max, Mean, SD, Min, Max)
(File D:\Master Thesis\202106_DataAnalysis\202106_Table_Results\202106_5_CRER1distribution1.doc already exists, option ap
> pend was assumed)
Click to Open File:  D:\Master Thesis\202106_DataAnalysis\202106_Table_Results\202106_5_CRER1distribution1.doc

.         *Basic Materials
.                 *Overall
.                 sum CRER1 if Sector == "Basic Materials"

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       CRER1 |        829    .3162875    .1290764   .0280325   .8806031

.                 asdoc, accum(`r(mean)', `r(sd)', `r(min)', `r(max)')

.                 *US
.                 sum CRER1 if Sector == "Basic Materials" & Country == "United States of America"

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       CRER1 |        552    .3167462    .1310759   .0280325   .8255899

.                 asdoc, accum(`r(mean)', `r(sd)', `r(min)', `r(max)')

.                 *EU
.                 sum CRER1 if Sector == "Basic Materials" & Country != "United States of America"

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       CRER1 |        277    .3153735    .1252253    .082881   .8806031

.                 asdoc, accum(`r(mean)', `r(sd)', `r(min)', `r(max)')

.                 asdoc, row(Basic Materials, $accum) dec(2)
(File D:\Master Thesis\202106_DataAnalysis\202106_Table_Results\202106_5_CRER1distribution1.doc already exists, option ap
> pend was assumed)
Click to Open File:  D:\Master Thesis\202106_DataAnalysis\202106_Table_Results\202106_5_CRER1distribution1.doc

.         *Consumer Cyclicals
.                 *Overall
.                 sum CRER1 if Sector == "Consumer Cyclicals"

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       CRER1 |      2,225    .2425796    .1570811   .0083081   .9363745

.                 asdoc, accum(`r(mean)', `r(sd)', `r(min)', `r(max)')

.                 *US
.                 sum CRER1 if Sector == "Consumer Cyclicals" & Country == "United States of America"

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       CRER1 |      1,701    .2525155    .1607781   .0083081   .7925825

.                 asdoc, accum(`r(mean)', `r(sd)', `r(min)', `r(max)')

.                 *EU
.                 sum CRER1 if Sector == "Consumer Cyclicals" & Country != "United States of America"

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       CRER1 |        524    .2103259    .1397804   .0187676   .9363745

.                 asdoc, accum(`r(mean)', `r(sd)', `r(min)', `r(max)')

.                 asdoc, row(Consumer Cyclicals, $accum) dec(2)
(File D:\Master Thesis\202106_DataAnalysis\202106_Table_Results\202106_5_CRER1distribution1.doc already exists, option ap
> pend was assumed)
Click to Open File:  D:\Master Thesis\202106_DataAnalysis\202106_Table_Results\202106_5_CRER1distribution1.doc

.         *Consumer Non-Cyclicals
.                 *Overall
.                 sum CRER1 if Sector == "Consumer Non-Cyclicals"

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       CRER1 |        939     .220156    .1217428   .0174743   .7899649

.                 asdoc, accum(`r(mean)', `r(sd)', `r(min)', `r(max)')

.                 *US
.                 sum CRER1 if Sector == "Consumer Non-Cyclicals" & Country == "United States of America"

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       CRER1 |        674    .2150815    .1232526   .0174743   .7899649

.                 asdoc, accum(`r(mean)', `r(sd)', `r(min)', `r(max)')

.                 *EU
.                 sum CRER1 if Sector == "Consumer Non-Cyclicals" & Country != "United States of America"

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       CRER1 |        265    .2330623    .1170537   .0307912   .5332715

.                 asdoc, accum(`r(mean)', `r(sd)', `r(min)', `r(max)')

.                 asdoc, row(Consumer Non-Cyclicals, $accum) dec(2)
(File D:\Master Thesis\202106_DataAnalysis\202106_Table_Results\202106_5_CRER1distribution1.doc already exists, option ap
> pend was assumed)
Click to Open File:  D:\Master Thesis\202106_DataAnalysis\202106_Table_Results\202106_5_CRER1distribution1.doc

.         *Energy
.                 *Overall
.                 sum CRER1 if Sector == "Energy"

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       CRER1 |        415    .3709672     .195839   .0479616    .951176

.                 asdoc, accum(`r(mean)', `r(sd)', `r(min)', `r(max)')

.                 *US
.                 sum CRER1 if Sector == "Energy" & Country == "United States of America"

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       CRER1 |        270    .4065347     .207577   .0509815    .951176

.                 asdoc, accum(`r(mean)', `r(sd)', `r(min)', `r(max)')

.                 *EU
.                 sum CRER1 if Sector == "Energy" & Country != "United States of America"

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       CRER1 |        145    .3047382    .1516073   .0479616   .6644444

.                 asdoc, accum(`r(mean)', `r(sd)', `r(min)', `r(max)')

.                 asdoc, row(Energy, $accum) dec(2)
(File D:\Master Thesis\202106_DataAnalysis\202106_Table_Results\202106_5_CRER1distribution1.doc already exists, option ap
> pend was assumed)
Click to Open File:  D:\Master Thesis\202106_DataAnalysis\202106_Table_Results\202106_5_CRER1distribution1.doc

.         *Financials
.                 *Overall
.                 sum CRER1 if Sector == "Financials"

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       CRER1 |      1,934    .0219165    .0331932   .0005304   .3363838

.                 asdoc, accum(`r(mean)', `r(sd)', `r(min)', `r(max)')

.                 *US
.                 sum CRER1 if Sector == "Financials" & Country == "United States of America"

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       CRER1 |      1,506    .0226104    .0336005    .000693   .3363838

.                 asdoc, accum(`r(mean)', `r(sd)', `r(min)', `r(max)')

.                 *EU
.                 sum CRER1 if Sector == "Financials" & Country != "United States of America"

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       CRER1 |        428    .0194747    .0316356   .0005304   .2705923

.                 asdoc, accum(`r(mean)', `r(sd)', `r(min)', `r(max)')

.                 asdoc, row(Financials, $accum) dec(2)
(File D:\Master Thesis\202106_DataAnalysis\202106_Table_Results\202106_5_CRER1distribution1.doc already exists, option ap
> pend was assumed)
Click to Open File:  D:\Master Thesis\202106_DataAnalysis\202106_Table_Results\202106_5_CRER1distribution1.doc

.         *Healthcare
.                 *Overall
.                 sum CRER1 if Sector == "Healthcare"

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       CRER1 |      1,765    .1307037    .1067308   .0008419   .8422812

.                 asdoc, accum(`r(mean)', `r(sd)', `r(min)', `r(max)')

.                 *US
.                 sum CRER1 if Sector == "Healthcare" & Country == "United States of America"

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       CRER1 |      1,483    .1272005    .1067425   .0008419   .8422812

.                 asdoc, accum(`r(mean)', `r(sd)', `r(min)', `r(max)')

.                 *EU
.                 sum CRER1 if Sector == "Healthcare" & Country != "United States of America"

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       CRER1 |        282    .1491267    .1049452   .0169099   .5768142

.                 asdoc, accum(`r(mean)', `r(sd)', `r(min)', `r(max)')

.                 asdoc, row(Healthcare, $accum) dec(2)
(File D:\Master Thesis\202106_DataAnalysis\202106_Table_Results\202106_5_CRER1distribution1.doc already exists, option ap
> pend was assumed)
Click to Open File:  D:\Master Thesis\202106_DataAnalysis\202106_Table_Results\202106_5_CRER1distribution1.doc

.         *Industrials
.                 *Overall
.                 sum CRER1 if Sector == "Industrials"

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       CRER1 |      2,353    .1762361    .1364764   .0010187   .9062386

.                 asdoc, accum(`r(mean)', `r(sd)', `r(min)', `r(max)')

.                 *US
.                 sum CRER1 if Sector == "Industrials" & Country == "United States of America"

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       CRER1 |      1,582    .1765066     .137126   .0107274   .8371003

.                 asdoc, accum(`r(mean)', `r(sd)', `r(min)', `r(max)')

.                 *EU
.                 sum CRER1 if Sector == "Industrials" & Country != "United States of America"

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       CRER1 |        771     .175681    .1352205   .0010187   .9062386

.                 asdoc, accum(`r(mean)', `r(sd)', `r(min)', `r(max)')

.                 asdoc, row(Industrials, $accum) dec(2)
(File D:\Master Thesis\202106_DataAnalysis\202106_Table_Results\202106_5_CRER1distribution1.doc already exists, option ap
> pend was assumed)
Click to Open File:  D:\Master Thesis\202106_DataAnalysis\202106_Table_Results\202106_5_CRER1distribution1.doc

.         *Technology
.                 *Overall
.                 sum CRER1 if Sector == "Technology"

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       CRER1 |      2,026     .125839    .1088772    .006904   .8487887

.                 asdoc, accum(`r(mean)', `r(sd)', `r(min)', `r(max)')

.                 *US
.                 sum CRER1 if Sector == "Technology" & Country == "United States of America"

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       CRER1 |      1,722    .1207296    .1030666    .006904   .8487887

.                 asdoc, accum(`r(mean)', `r(sd)', `r(min)', `r(max)')

.                 *EU
.                 sum CRER1 if Sector == "Technology" & Country != "United States of America"

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       CRER1 |        304    .1547812    .1337891   .0099565    .610913

.                 asdoc, accum(`r(mean)', `r(sd)', `r(min)', `r(max)')

.                 asdoc, row(Technology, $accum) dec(2)
(File D:\Master Thesis\202106_DataAnalysis\202106_Table_Results\202106_5_CRER1distribution1.doc already exists, option ap
> pend was assumed)
Click to Open File:  D:\Master Thesis\202106_DataAnalysis\202106_Table_Results\202106_5_CRER1distribution1.doc

.         *Utilities
.                 *Overall
.                 sum CRER1 if Sector == "Utilities"

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       CRER1 |        384    .2342447    .2215585   .0089332   .8232364

.                 asdoc, accum(`r(mean)', `r(sd)', `r(min)', `r(max)')

.                 *US
.                 sum CRER1 if Sector == "Utilities" & Country == "United States of America"

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       CRER1 |        268    .1664214    .2044042   .0089332   .7951558

.                 asdoc, accum(`r(mean)', `r(sd)', `r(min)', `r(max)')

.                 *EU
.                 sum CRER1 if Sector == "Utilities" & Country != "United States of America"

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       CRER1 |        116    .3909399    .1760489   .0245344   .8232364

.                 asdoc, accum(`r(mean)', `r(sd)', `r(min)', `r(max)')

.                 asdoc, row(Utilities, $accum) dec(2)
(File D:\Master Thesis\202106_DataAnalysis\202106_Table_Results\202106_5_CRER1distribution1.doc already exists, option ap
> pend was assumed)
Click to Open File:  D:\Master Thesis\202106_DataAnalysis\202106_Table_Results\202106_5_CRER1distribution1.doc

.         *All sectors
.                 *Overall
.                 sum CRER1

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       CRER1 |     12,870    .1705735    .1543608   .0005304    .951176

.                 asdoc, accum(`r(mean)', `r(sd)', `r(min)', `r(max)')

.                 *US
.                 sum CRER1 if Country == "United States of America"

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       CRER1 |      9,758    .1653538    .1543311    .000693    .951176

.                 asdoc, accum(`r(mean)', `r(sd)', `r(min)', `r(max)')

.                 *EU
.                 sum CRER1 if Country != "United States of America"

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
       CRER1 |      3,112    .1869406    .1533303   .0005304   .9363745

.                 asdoc, accum(`r(mean)', `r(sd)', `r(min)', `r(max)')

.                 asdoc, row(All sectors, $accum) dec(2)
(File D:\Master Thesis\202106_DataAnalysis\202106_Table_Results\202106_5_CRER1distribution1.doc already exists, option ap
> pend was assumed)
Click to Open File:  D:\Master Thesis\202106_DataAnalysis\202106_Table_Results\202106_5_CRER1distribution1.doc

. 
end of do-file

. do "D:\Master Thesis\202106_DataAnalysis\202106_DO_File\202106_3_ManageVariables.do"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Manage variables
>                                         - Label and rename existing variables
>                                         - Generate varibles and add Label use for regression
> \********************************************************************************************************************/
. 
. clear

. capture log close
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   5 Jun 2021, 18:29:43

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. *************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a n
> egative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra acco
> unt to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a 
> contra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated In
> tangible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gr
> oss - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + 
> PrepaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm +
>  OtherLongTermAssetsTotal

.                         *CRER using total assets gross
.                                 gen CRER = CRE / TotalAssetGross

.                                 drop if CRER == 1
(4 observations deleted)

.                                 drop if CRER < 0.009
(4,638 observations deleted)

.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(4 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

.                         
.         /*****************\
>          Others variables
>         \*****************/
.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Sector)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(12,306 real changes made)

.         
. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(21,477 observations deleted)

.                 drop if CEOBoardMember == .
(457 observations deleted)

.                 drop if Sector == "Academic & Educational Services"
(67 observations deleted)

.         xtset FirmID FiscalYear
       panel variable:  FirmID (unbalanced)
        time variable:  FiscalYear, 2011 to 2020, but with gaps
                delta:  1 unit

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

. 
end of do-file

. do "D:\Master Thesis\202106_DataAnalysis\202106_DO_File\202106_4_SumObs.do"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Summary Observations
> \********************************************************************************************************************/
. 
. clear

. capture log close
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   5 Jun 2021, 21:04:45

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. *************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a n
> egative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra acco
> unt to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a 
> contra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated In
> tangible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gr
> oss - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + 
> PrepaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm +
>  OtherLongTermAssetsTotal

.                         *CRER using total assets gross
.                                 gen CRER = CRE / TotalAssetGross

.                                 drop if CRER == 1
(4 observations deleted)

.                                 drop if CRER < 0.009
(4,638 observations deleted)

.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(4 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

.                         
.         /*****************\
>          Others variables
>         \*****************/
.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Sector)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(12,306 real changes made)

.         
. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(21,477 observations deleted)

.                 drop if CEOBoardMember == .
(457 observations deleted)

.                 drop if Sector == "Academic & Educational Services"
(67 observations deleted)

.         xtset FirmID FiscalYear
       panel variable:  FirmID (unbalanced)
        time variable:  FiscalYear, 2011 to 2020, but with gaps
                delta:  1 unit

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

. 
end of do-file

. do "D:\Master Thesis\202106_DataAnalysis\202106_DO_File\202106_4_SumObs.do"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Summary Observations
> \********************************************************************************************************************/
. 
. clear

. capture log close
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   6 Jun 2021, 01:51:57

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. **********************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a n
> egative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra acco
> unt to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a 
> contra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated In
> tangible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gr
> oss - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + 
> PrepaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm +
>  OtherLongTermAssetsTotal

.                         *CRER using total assets gross
.                                 gen CRER = CRE / TotalAssetGross

.                                 drop if CRER == 1
(4 observations deleted)

.                                 *drop if CRER < 0.009
.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(5 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

.                         
.         /*****************\
>          Others variables
>         \*****************/
.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Sector)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(13,890 real changes made)

.         
. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(25,139 observations deleted)

.                 drop if CEOBoardMember == .
(482 observations deleted)

.                 drop if Sector == "Academic & Educational Services"
(72 observations deleted)

.         xtset FirmID FiscalYear
       panel variable:  FirmID (unbalanced)
        time variable:  FiscalYear, 2011 to 2020, but with gaps
                delta:  1 unit

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

. 
end of do-file

.         /**************************************************************************************************************
> ******\
>                 4.  Summary observation
>         \**************************************************************************************************************
> ******/
.                         do "D:\Master Thesis\202106_DataAnalysis\202106_DO_File\202106_4_SumObs.do"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Summary Observations
> \********************************************************************************************************************/
. 
. clear

. capture log close
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   6 Jun 2021, 02:17:40

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. **********************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a n
> egative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra acco
> unt to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a 
> contra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated In
> tangible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gr
> oss - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + 
> PrepaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm +
>  OtherLongTermAssetsTotal

.                         *CRER using total assets gross
.                                 gen CRER = CRE / TotalAssetGross

.                                 drop if CRER == 1
(4 observations deleted)

.                                 *drop if CRER < 0.009
.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(5 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

.                         
.         /*****************\
>          Others variables
>         \*****************/
.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Sector)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(13,890 real changes made)

.         
. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(25,139 observations deleted)

.                 drop if CEOBoardMember == .
(482 observations deleted)

.                 drop if Sector == "Academic & Educational Services"
(72 observations deleted)

.         xtset FirmID FiscalYear
       panel variable:  FirmID (unbalanced)
        time variable:  FiscalYear, 2011 to 2020, but with gaps
                delta:  1 unit

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

. 
end of do-file

.         /**************************************************************************************************************
> ******\
>                 4.  Summary observation
>         \**************************************************************************************************************
> ******/
.                         do "D:\Master Thesis\202106_DataAnalysis\202106_DO_File\202106_4_SumObs.do"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Summary Observations
> \********************************************************************************************************************/
. 
. clear

. capture log close
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   6 Jun 2021, 02:31:13

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. **********************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a n
> egative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra acco
> unt to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a 
> contra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated In
> tangible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gr
> oss - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + 
> PrepaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm +
>  OtherLongTermAssetsTotal

.                         *CRER using total assets gross
.                                 gen CRER = CRE / TotalAssetGross

.                                 drop if CRER == 1
(4 observations deleted)

.                                 drop if CRER < 0.005
(2,985 observations deleted)

.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(5 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

.                         
.         /*****************\
>          Others variables
>         \*****************/
.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Sector)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(12,785 real changes made)

.         
. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(22,698 observations deleted)

.                 drop if CEOBoardMember == .
(464 observations deleted)

.                 drop if Sector == "Academic & Educational Services"
(68 observations deleted)

.         xtset FirmID FiscalYear
       panel variable:  FirmID (unbalanced)
        time variable:  FiscalYear, 2011 to 2020, but with gaps
                delta:  1 unit

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

. 
end of do-file

. do "C:\Users\GL\AppData\Local\Temp\STD2c0c_000000.tmp"

.         /**************************************************************************************************************
> ******\
>                 7.  Pearson pair-wise Correlation 
>         \**************************************************************************************************************
> ******/
.                         do "D:\Master Thesis\202106_DataAnalysis\202106_DO_File\202106_7_pwcorr.do"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Correlation table
> \********************************************************************************************************************/
. 
. clear

. capture log close
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   6 Jun 2021, 02:34:35

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. **********************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a n
> egative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra acco
> unt to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a 
> contra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated In
> tangible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gr
> oss - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + 
> PrepaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm +
>  OtherLongTermAssetsTotal

.                         *CRER using total assets gross
.                                 gen CRER = CRE / TotalAssetGross

.                                 drop if CRER == 1
(4 observations deleted)

.                                 drop if CRER < 0.004
(2,533 observations deleted)

.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(5 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

.                         
.         /*****************\
>          Others variables
>         \*****************/
.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Sector)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(12,931 real changes made)

.         
. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(23,045 observations deleted)

.                 drop if CEOBoardMember == .
(466 observations deleted)

.                 drop if Sector == "Academic & Educational Services"
(72 observations deleted)

.         xtset FirmID FiscalYear
       panel variable:  FirmID (unbalanced)
        time variable:  FiscalYear, 2011 to 2020, but with gaps
                delta:  1 unit

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

. 
end of do-file

. do "C:\Users\GL\AppData\Local\Temp\STD2c0c_000000.tmp"

.                         do "D:\Master Thesis\202106_DataAnalysis\202106_DO_File\202106_4_SumObs.do"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Summary Observations
> \********************************************************************************************************************/
. 
. clear

. capture log close
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   6 Jun 2021, 02:37:17

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. **********************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a n
> egative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra acco
> unt to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a 
> contra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated In
> tangible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gr
> oss - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + 
> PrepaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm +
>  OtherLongTermAssetsTotal

.                         *CRER using total assets gross
.                                 gen CRER = CRE / TotalAssetGross

.                                 drop if CRER == 1
(4 observations deleted)

.                                 drop if CRER < 0.009
(4,638 observations deleted)

.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(4 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

.                         
.         /*****************\
>          Others variables
>         \*****************/
.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Sector)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(12,306 real changes made)

.         
. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(21,477 observations deleted)

.                 drop if CEOBoardMember == .
(457 observations deleted)

.                 drop if Sector == "Academic & Educational Services"
(67 observations deleted)

.         xtset FirmID FiscalYear
       panel variable:  FirmID (unbalanced)
        time variable:  FiscalYear, 2011 to 2020, but with gaps
                delta:  1 unit

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

. 
end of do-file

.         /**************************************************************************************************************
> ******\
>                 4.  Summary observation
>         \**************************************************************************************************************
> ******/
.                         do "D:\Master Thesis\202106_DataAnalysis\202106_DO_File\202106_4_SumObs.do"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Summary Observations
> \********************************************************************************************************************/
. 
. clear

. capture log close
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   7 Jun 2021, 18:40:40

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. **********************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a n
> egative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra acco
> unt to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a 
> contra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated In
> tangible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gr
> oss - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + 
> PrepaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm +
>  OtherLongTermAssetsTotal

.                         *CRER using total assets gross
.                                 gen CRER = CRE / TotalAssetGross

.                                 drop if CRER == 1
(4 observations deleted)

.                                 drop if CRER < 0.009
(4,638 observations deleted)

.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(4 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

.                         
.         /*****************\
>          Others variables
>         \*****************/
.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Sector)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(12,306 real changes made)

.         
. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(21,477 observations deleted)

.                 drop if CEOBoardMember == .
(457 observations deleted)

.                 drop if Sector == "Academic & Educational Services"
(67 observations deleted)

.         xtset FirmID FiscalYear
       panel variable:  FirmID (unbalanced)
        time variable:  FiscalYear, 2011 to 2020, but with gaps
                delta:  1 unit

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

. 
end of do-file

. sum TobinQ

    Variable |        Obs        Mean    Std. Dev.       Min        Max
-------------+---------------------------------------------------------
      TobinQ |     12,870     2.22982     1.99413   .2941868   41.96585

. exit, clear
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   8 Jun 2021, 11:54:52

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. **********************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a n
> egative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra acco
> unt to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a 
> contra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated In
> tangible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gr
> oss - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + 
> PrepaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm +
>  OtherLongTermAssetsTotal

.                         *CRER using total assets gross
.                                 gen CRER = CRE / TotalAssetGross

.                                 drop if CRER == 1
(4 observations deleted)

.                                 drop if CRER < 0.004
(2,533 observations deleted)

.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(5 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

.                         
.         /*****************\
>          Others variables
>         \*****************/
.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Sector)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(12,931 real changes made)

.         
. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(23,045 observations deleted)

.                 drop if CEOBoardMember == .
(466 observations deleted)

.                 drop if Sector == "Academic & Educational Services"
(72 observations deleted)

.         xtset FirmID FiscalYear
       panel variable:  FirmID (unbalanced)
        time variable:  FiscalYear, 2011 to 2020, but with gaps
                delta:  1 unit

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

. 
end of do-file

.         /**************************************************************************************************************
> ******\
>                 4.  Summary observation
>         \**************************************************************************************************************
> ******/
.                         do "D:\Master Thesis\202106_DataAnalysis\202106_DO_File\202106_4_SumObs.do"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Summary Observations
> \********************************************************************************************************************/
. 
. clear

. capture log close
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   8 Jun 2021, 11:58:48

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. **********************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a n
> egative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra acco
> unt to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a 
> contra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated In
> tangible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gr
> oss - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + 
> PrepaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm +
>  OtherLongTermAssetsTotal

.                         *CRER using total assets gross
.                                 gen CRER = CRE / TotalAssetGross

.                                 drop if CRER == 1
(4 observations deleted)

.                                 *drop if CRER < 0.004
.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(5 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

.                         
.         /*****************\
>          Others variables
>         \*****************/
.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Sector)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(13,890 real changes made)

.         
. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(25,139 observations deleted)

.                 drop if CEOBoardMember == .
(482 observations deleted)

.                 drop if Sector == "Academic & Educational Services"
(72 observations deleted)

.         xtset FirmID FiscalYear
       panel variable:  FirmID (unbalanced)
        time variable:  FiscalYear, 2011 to 2020, but with gaps
                delta:  1 unit

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

. 
end of do-file

.         /**************************************************************************************************************
> ******\
>                 4.  Summary observation
>         \**************************************************************************************************************
> ******/
.                         do "D:\Master Thesis\202106_DataAnalysis\202106_DO_File\202106_4_SumObs.do"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Summary Observations
> \********************************************************************************************************************/
. 
. clear

. capture log close
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   8 Jun 2021, 12:01:39

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. **********************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a n
> egative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra acco
> unt to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a 
> contra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated In
> tangible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gr
> oss - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + 
> PrepaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm +
>  OtherLongTermAssetsTotal

.                         *CRER using total assets gross
.                                 gen CRER = CRE / TotalAssetGross

.                                 drop if CRER == 1
(4 observations deleted)

.                                 drop if CRER < 0.009
(4,638 observations deleted)

.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(4 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

.                         
.         /*****************\
>          Others variables
>         \*****************/
.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Sector)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(12,306 real changes made)

.         
. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(21,477 observations deleted)

.                 drop if CEOBoardMember == .
(457 observations deleted)

.                 drop if Sector == "Academic & Educational Services"
(67 observations deleted)

.         xtset FirmID FiscalYear
       panel variable:  FirmID (unbalanced)
        time variable:  FiscalYear, 2011 to 2020, but with gaps
                delta:  1 unit

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

. 
end of do-file

.         /**************************************************************************************************************
> ******\
>                 4.  Summary observation
>         \**************************************************************************************************************
> ******/
.                         do "D:\Master Thesis\202106_DataAnalysis\202106_DO_File\202106_4_SumObs.do"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Summary Observations
> \********************************************************************************************************************/
. 
. clear

. capture log close
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   8 Jun 2021, 12:06:02

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. **********************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a n
> egative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra acco
> unt to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a 
> contra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated In
> tangible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gr
> oss - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + 
> PrepaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm +
>  OtherLongTermAssetsTotal

.                         *CRER using total assets gross
.                                 gen CRER = CRE / TotalAssetGross

.                                 drop if CRER == 1
(4 observations deleted)

.                                 drop if CRER < 0.005
(2,985 observations deleted)

.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(5 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

.                         
.         /*****************\
>          Others variables
>         \*****************/
.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Sector)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(12,785 real changes made)

.         
. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(22,698 observations deleted)

.                 drop if CEOBoardMember == .
(464 observations deleted)

.                 drop if Sector == "Academic & Educational Services"
(68 observations deleted)

.         xtset FirmID FiscalYear
       panel variable:  FirmID (unbalanced)
        time variable:  FiscalYear, 2011 to 2020, but with gaps
                delta:  1 unit

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

. 
end of do-file

.         /**************************************************************************************************************
> ******\
>                 4.  Summary observation
>         \**************************************************************************************************************
> ******/
.                         do "D:\Master Thesis\202106_DataAnalysis\202106_DO_File\202106_4_SumObs.do"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Summary Observations
> \********************************************************************************************************************/
. 
. clear

. capture log close
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   8 Jun 2021, 14:15:44

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. **********************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a n
> egative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra acco
> unt to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a 
> contra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated In
> tangible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gr
> oss - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + 
> PrepaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm +
>  OtherLongTermAssetsTotal

.                         *CRER using total assets gross
.                                 gen CRER = CRE / TotalAssetGross

.                                 drop if CRER == 1
(4 observations deleted)

.                                 drop if CRER < 0.005
(2,985 observations deleted)

.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(5 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

.                         
.         /*****************\
>          Others variables
>         \*****************/
.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Sector)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(12,785 real changes made)

.         
. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(22,698 observations deleted)

.                 drop if CEOBoardMember == .
(464 observations deleted)

.                 drop if Sector == "Academic & Educational Services"
(68 observations deleted)

.         xtset FirmID FiscalYear
       panel variable:  FirmID (unbalanced)
        time variable:  FiscalYear, 2011 to 2020, but with gaps
                delta:  1 unit

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

. 
end of do-file

.         /**************************************************************************************************************
> ******\
>                 4.  Summary observation
>         \**************************************************************************************************************
> ******/
.                         do "D:\Master Thesis\202106_DataAnalysis\202106_DO_File\202106_4_SumObs.do"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Summary Observations
> \********************************************************************************************************************/
. 
. clear

. capture log close
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   8 Jun 2021, 14:20:46

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. **********************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a n
> egative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra acco
> unt to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a 
> contra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated In
> tangible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gr
> oss - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + 
> PrepaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm +
>  OtherLongTermAssetsTotal

.                         *CRER using total assets gross
.                                 gen CRER = CRE / TotalAssetGross

.                                 drop if CRER == 1
(4 observations deleted)

.                                 drop if CRER < 0.009
(4,638 observations deleted)

.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(4 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

.                         
.         /*****************\
>          Others variables
>         \*****************/
.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Sector)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(12,306 real changes made)

.         
. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(21,477 observations deleted)

.                 drop if CEOBoardMember == .
(457 observations deleted)

.                 drop if Sector == "Academic & Educational Services"
(67 observations deleted)

.         xtset FirmID FiscalYear
       panel variable:  FirmID (unbalanced)
        time variable:  FiscalYear, 2011 to 2020, but with gaps
                delta:  1 unit

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

. 
end of do-file

.         /**************************************************************************************************************
> ******\
>                 4.  Summary observation
>         \**************************************************************************************************************
> ******/
.                         do "D:\Master Thesis\202106_DataAnalysis\202106_DO_File\202106_4_SumObs.do"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Summary Observations
> \********************************************************************************************************************/
. 
. clear

. capture log close
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   8 Jun 2021, 14:25:51

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. **********************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a n
> egative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra acco
> unt to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a 
> contra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated In
> tangible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gr
> oss - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + 
> PrepaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm +
>  OtherLongTermAssetsTotal

.                         *CRER using total assets gross
.                                 gen CRER = CRE / TotalAssetGross

.                                 drop if CRER == 1
(4 observations deleted)

.                                 drop if CRER < 0.005
(2,985 observations deleted)

.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(5 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

.                         
.         /*****************\
>          Others variables
>         \*****************/
.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Sector)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(12,785 real changes made)

.         
. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(22,698 observations deleted)

.                 drop if CEOBoardMember == .
(464 observations deleted)

.                 drop if Sector == "Academic & Educational Services"
(68 observations deleted)

.         xtset FirmID FiscalYear
       panel variable:  FirmID (unbalanced)
        time variable:  FiscalYear, 2011 to 2020, but with gaps
                delta:  1 unit

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

. 
end of do-file

.         /**************************************************************************************************************
> ******\
>                 4.  Summary observation
>         \**************************************************************************************************************
> ******/
.                         do "D:\Master Thesis\202106_DataAnalysis\202106_DO_File\202106_4_SumObs.do"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Summary Observations
> \********************************************************************************************************************/
. 
. clear

. capture log close
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   8 Jun 2021, 14:36:18

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. **********************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a n
> egative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra acco
> unt to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a 
> contra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated In
> tangible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gr
> oss - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + 
> PrepaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm +
>  OtherLongTermAssetsTotal

.                         *CRER using total assets gross
.                                 gen CRER = CRE / TotalAssetGross

.                                 drop if CRER == 1
(4 observations deleted)

.                                 drop if CRER < 0.009
(4,638 observations deleted)

.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(4 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

.                         
.         /*****************\
>          Others variables
>         \*****************/
.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Sector)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(12,306 real changes made)

.         
. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(21,477 observations deleted)

.                 drop if CEOBoardMember == .
(457 observations deleted)

.                 drop if Sector == "Academic & Educational Services"
(67 observations deleted)

.         xtset FirmID FiscalYear
       panel variable:  FirmID (unbalanced)
        time variable:  FiscalYear, 2011 to 2020, but with gaps
                delta:  1 unit

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

. 
end of do-file

.         /**************************************************************************************************************
> ******\
>                 4.  Summary observation
>         \**************************************************************************************************************
> ******/
.                         do "D:\Master Thesis\202106_DataAnalysis\202106_DO_File\202106_4_SumObs.do"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Summary Observations
> \********************************************************************************************************************/
. 
. clear

. capture log close
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   8 Jun 2021, 19:05:03

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. **********************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a n
> egative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra acco
> unt to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a 
> contra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated In
> tangible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gr
> oss - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + 
> PrepaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm +
>  OtherLongTermAssetsTotal

.                         *CRER using total assets gross
.                                 gen CRER = CRE / TotalAssetGross

.                                 drop if CRER == 1
(4 observations deleted)

.                                 drop if CRER < 0.009
(4,638 observations deleted)

.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(4 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

.                         
.         /*****************\
>          Others variables
>         \*****************/
.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Sector)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(12,306 real changes made)

.         
. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(21,477 observations deleted)

.                 drop if CEOBoardMember == .
(457 observations deleted)

.                 drop if Sector == "Academic & Educational Services"
(67 observations deleted)

.         xtset FirmID FiscalYear
       panel variable:  FirmID (unbalanced)
        time variable:  FiscalYear, 2011 to 2020, but with gaps
                delta:  1 unit

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

. 
end of do-file

.         /**************************************************************************************************************
> ******\
>                 4.  Summary observation
>         \**************************************************************************************************************
> ******/
.                         do "D:\Master Thesis\202106_DataAnalysis\202106_DO_File\202106_4_SumObs.do"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Summary Observations
> \********************************************************************************************************************/
. 
. clear

. capture log close
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   8 Jun 2021, 19:49:23

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. **********************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a n
> egative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra acco
> unt to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a 
> contra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated In
> tangible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gr
> oss - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + 
> PrepaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm +
>  OtherLongTermAssetsTotal

.                         *CRER using total assets gross
.                                 gen CRER = CRE / TotalAssetGross

.                                 drop if CRER == 1
(4 observations deleted)

.                                 drop if CRER < 0.009
(4,638 observations deleted)

.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(4 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

.                         
.         /*****************\
>          Others variables
>         \*****************/
.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Sector)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(12,306 real changes made)

.         
. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(21,477 observations deleted)

.                 drop if CEOBoardMember == .
(457 observations deleted)

.                 drop if Sector == "Academic & Educational Services"
(67 observations deleted)

.         xtset FirmID FiscalYear
       panel variable:  FirmID (unbalanced)
        time variable:  FiscalYear, 2011 to 2020, but with gaps
                delta:  1 unit

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

. 
end of do-file

.         /**************************************************************************************************************
> ******\
>                 4.  Summary observation
>         \**************************************************************************************************************
> ******/
.                         do "D:\Master Thesis\202106_DataAnalysis\202106_DO_File\202106_4_SumObs.do"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Summary Observations
> \********************************************************************************************************************/
. 
. clear

. capture log close
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   9 Jun 2021, 00:53:28

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. **********************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a n
> egative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra acco
> unt to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a 
> contra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated In
> tangible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gr
> oss - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + 
> PrepaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm +
>  OtherLongTermAssetsTotal

.                         *CRER using total assets gross
.                                 gen CRER = CRE / TotalAssetGross

.                                 drop if CRER == 1
(4 observations deleted)

.                                 drop if CRER < 0.009
(4,638 observations deleted)

.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(4 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

.                         
.         /*****************\
>          Others variables
>         \*****************/
.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Sector)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(12,306 real changes made)

.         
. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(21,477 observations deleted)

.                 drop if CEOBoardMember == .
(457 observations deleted)

.                 drop if Sector == "Academic & Educational Services"
(67 observations deleted)

.         xtset FirmID FiscalYear
       panel variable:  FirmID (unbalanced)
        time variable:  FiscalYear, 2011 to 2020, but with gaps
                delta:  1 unit

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

. 
end of do-file

.         /**************************************************************************************************************
> ******\
>                 4.  Summary observation
>         \**************************************************************************************************************
> ******/
.                         do "D:\Master Thesis\202106_DataAnalysis\202106_DO_File\202106_4_SumObs.do"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Summary Observations
> \********************************************************************************************************************/
. 
. clear

. capture log close
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   9 Jun 2021, 01:33:09

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. **********************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a n
> egative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra acco
> unt to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a 
> contra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated In
> tangible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gr
> oss - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + 
> PrepaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm +
>  OtherLongTermAssetsTotal

.                         *CRER using total assets gross
.                                 gen CRER = CRE / TotalAssetGross

.                                 drop if CRER == 1
(4 observations deleted)

.                                 drop if CRER < 0.009
(4,638 observations deleted)

.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(4 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

.                         
.         /*****************\
>          Others variables
>         \*****************/
.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Sector)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(12,306 real changes made)

.         
. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(21,477 observations deleted)

.                 drop if CEOBoardMember == .
(457 observations deleted)

.                 drop if Sector == "Academic & Educational Services"
(67 observations deleted)

.         xtset FirmID FiscalYear
       panel variable:  FirmID (unbalanced)
        time variable:  FiscalYear, 2011 to 2020, but with gaps
                delta:  1 unit

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

. 
end of do-file

.         /**************************************************************************************************************
> ******\
>                 4.  Summary observation
>         \**************************************************************************************************************
> ******/
.                         do "D:\Master Thesis\202106_DataAnalysis\202106_DO_File\202106_4_SumObs.do"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Summary Observations
> \********************************************************************************************************************/
. 
. clear

. capture log close
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   9 Jun 2021, 21:22:38

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. **********************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a n
> egative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra acco
> unt to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a 
> contra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated In
> tangible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gr
> oss - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + 
> PrepaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm +
>  OtherLongTermAssetsTotal

.                         *CRER using total assets gross
.                                 gen CRER = CRE / TotalAssetGross

.                                 drop if CRER == 1
(4 observations deleted)

.                                 drop if CRER < 0.009
(4,638 observations deleted)

.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(4 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

.                         
.         /*****************\
>          Others variables
>         \*****************/
.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Sector)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(12,306 real changes made)

.         
. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(21,477 observations deleted)

.                 drop if CEOBoardMember == .
(457 observations deleted)

.                 drop if Sector == "Academic & Educational Services"
(67 observations deleted)

.         xtset FirmID FiscalYear
       panel variable:  FirmID (unbalanced)
        time variable:  FiscalYear, 2011 to 2020, but with gaps
                delta:  1 unit

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

. 
end of do-file

.         /**************************************************************************************************************
> ******\
>                 4.  Summary observation
>         \**************************************************************************************************************
> ******/
.                         do "D:\Master Thesis\202106_DataAnalysis\202106_DO_File\202106_4_SumObs.do"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Summary Observations
> \********************************************************************************************************************/
. 
. clear

. capture log close
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   9 Jun 2021, 21:39:27

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. **********************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a n
> egative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra acco
> unt to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a 
> contra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated In
> tangible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gr
> oss - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + 
> PrepaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm +
>  OtherLongTermAssetsTotal

.                         *CRER using total assets gross
.                                 gen CRER = CRE / TotalAssetGross

.                                 drop if CRER == 1
(4 observations deleted)

.                                 drop if CRER < 0.009
(4,638 observations deleted)

.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(4 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

.                         
.         /*****************\
>          Others variables
>         \*****************/
.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Sector)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(12,306 real changes made)

.         
. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(21,477 observations deleted)

.                 drop if CEOBoardMember == .
(457 observations deleted)

.                 drop if Sector == "Academic & Educational Services"
(67 observations deleted)

.         xtset FirmID FiscalYear
       panel variable:  FirmID (unbalanced)
        time variable:  FiscalYear, 2011 to 2020, but with gaps
                delta:  1 unit

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

. 
end of do-file

. do "D:\Master Thesis\202106_DataAnalysis\202106_DO_File\202106_4_SumObs.do"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Summary Observations
> \********************************************************************************************************************/
. 
. clear

. capture log close
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   9 Jun 2021, 21:43:33

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. **********************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a n
> egative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra acco
> unt to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a 
> contra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated In
> tangible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gr
> oss - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + 
> PrepaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm +
>  OtherLongTermAssetsTotal

.                         *CRER using total assets gross
.                                 gen CRER = CRE / TotalAssetGross

.                                 drop if CRER == 1
(4 observations deleted)

.                                 drop if CRER < 0.009
(4,638 observations deleted)

.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(4 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

.                         
.         /*****************\
>          Others variables
>         \*****************/
.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Sector)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(12,306 real changes made)

.         
. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(21,477 observations deleted)

.                 drop if CEOBoardMember == .
(457 observations deleted)

.                 drop if Sector == "Academic & Educational Services"
(67 observations deleted)

.         xtset FirmID FiscalYear
       panel variable:  FirmID (unbalanced)
        time variable:  FiscalYear, 2011 to 2020, but with gaps
                delta:  1 unit

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

. 
end of do-file

.         /**************************************************************************************************************
> ******\
>                 4.  Summary observation
>         \**************************************************************************************************************
> ******/
.                         do "D:\Master Thesis\202106_DataAnalysis\202106_DO_File\202106_4_SumObs.do"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Summary Observations
> \********************************************************************************************************************/
. 
. clear

. capture log close
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   9 Jun 2021, 23:36:10

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. **********************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a n
> egative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra acco
> unt to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a 
> contra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated In
> tangible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gr
> oss - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + 
> PrepaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm +
>  OtherLongTermAssetsTotal

.                         *CRER using total assets gross
.                                 gen CRER = CRE / TotalAssetGross

.                                 drop if CRER == 1
(4 observations deleted)

.                                 drop if CRER < 0.009
(4,638 observations deleted)

.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(4 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

.                         
.         /*****************\
>          Others variables
>         \*****************/
.         drop if Sector == "Academic & Educational Services"
(158 observations deleted)

.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Sector)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(12,301 real changes made)

.         
. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(21,386 observations deleted)

.                 drop if CEOBoardMember == .
(457 observations deleted)

.                 
.         xtset FirmID FiscalYear
       panel variable:  FirmID (unbalanced)
        time variable:  FiscalYear, 2011 to 2020, but with gaps
                delta:  1 unit

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

. 
end of do-file

.         /**************************************************************************************************************
> ******\
>                 4.  Summary observation
>         \**************************************************************************************************************
> ******/
.                         do "D:\Master Thesis\202106_DataAnalysis\202106_DO_File\202106_4_SumObs.do"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Summary Observations
> \********************************************************************************************************************/
. 
. clear

. capture log close
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:  12 Jun 2021, 17:23:02

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. **********************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a n
> egative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra acco
> unt to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a 
> contra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated In
> tangible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gr
> oss - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + 
> PrepaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm +
>  OtherLongTermAssetsTotal

.                         *CRER using total assets gross
.                                 gen CRER = CRE / TotalAssetGross

.                                 drop if CRER == 1
(4 observations deleted)

.                                 drop if CRER < 0.009
(4,638 observations deleted)

.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(4 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

.                         
.         /*****************\
>          Others variables
>         \*****************/
.         drop if Sector == "Academic & Educational Services"
(158 observations deleted)

.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Sector)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(12,301 real changes made)

.         
. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(21,386 observations deleted)

.                 drop if CEOBoardMember == .
(457 observations deleted)

.                 
.         xtset FirmID FiscalYear
       panel variable:  FirmID (unbalanced)
        time variable:  FiscalYear, 2011 to 2020, but with gaps
                delta:  1 unit

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

. 
end of do-file

. do "D:\Master Thesis\202106_DataAnalysis\202106_DO_File\202106_10_Graph.do"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 12 June 2021
>   Description  : Graph
> \********************************************************************************************************************/
. 
. clear

. capture log close
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   1 Jul 2021, 14:29:55

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. **********************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a n
> egative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra acco
> unt to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a 
> contra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated In
> tangible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gr
> oss - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + 
> PrepaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm +
>  OtherLongTermAssetsTotal

.                         *CRER using total assets gross
.                                 gen CRER = CRE / TotalAssetGross

.                                 drop if CRER == 1
(4 observations deleted)

.                                 drop if CRER < 0.009
(4,638 observations deleted)

.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(4 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

.                         
.         /*****************\
>          Others variables
>         \*****************/
.         drop if Sector == "Academic & Educational Services"
(158 observations deleted)

.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Sector)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(12,301 real changes made)

.         
. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(21,386 observations deleted)

.                 drop if CEOBoardMember == .
(457 observations deleted)

.                 
.         xtset FirmID FiscalYear
       panel variable:  FirmID (unbalanced)
        time variable:  FiscalYear, 2011 to 2020, but with gaps
                delta:  1 unit

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

. 
end of do-file

.         /**************************************************************************************************************
> ******\
>                 4.  Summary observation
>         \**************************************************************************************************************
> ******/
.                         do "D:\Master Thesis\202106_DataAnalysis\202106_DO_File\202106_4_SumObs.do"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Summary Observations
> \********************************************************************************************************************/
. 
. clear

. capture log close
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   1 Jul 2021, 22:28:48

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. **********************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a n
> egative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra acco
> unt to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a 
> contra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated In
> tangible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gr
> oss - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + 
> PrepaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm +
>  OtherLongTermAssetsTotal

.                         *CRER using total assets gross
.                                 gen CRER = CRE / TotalAssetGross

.                                 drop if CRER == 1
(4 observations deleted)

.                                 drop if CRER < 0.009
(4,638 observations deleted)

.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(4 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

.                         
.         /*****************\
>          Others variables
>         \*****************/
.         drop if Sector == "Academic & Educational Services"
(158 observations deleted)

.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Sector)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(12,301 real changes made)

.         
. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(21,386 observations deleted)

.                 drop if CEOBoardMember == .
(457 observations deleted)

.                 
.         xtset FirmID FiscalYear
       panel variable:  FirmID (unbalanced)
        time variable:  FiscalYear, 2011 to 2020, but with gaps
                delta:  1 unit

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

. 
end of do-file

.         /**************************************************************************************************************
> ******\
>                 4.  Summary observation
>         \**************************************************************************************************************
> ******/
.                         do "D:\Master Thesis\202106_DataAnalysis\202106_DO_File\202106_4_SumObs.do"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Summary Observations
> \********************************************************************************************************************/
. 
. clear

. capture log close
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   2 Jul 2021, 15:38:04

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. **********************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a n
> egative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra acco
> unt to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a 
> contra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated In
> tangible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gr
> oss - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + 
> PrepaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm +
>  OtherLongTermAssetsTotal

.                         *CRER using total assets gross
.                                 gen CRER = CRE / TotalAssetGross

.                                 drop if CRER == 1
(4 observations deleted)

.                                 drop if CRER < 0.009
(4,638 observations deleted)

.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(4 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

.                         
.         /*****************\
>          Others variables
>         \*****************/
.         drop if Sector == "Academic & Educational Services"
(158 observations deleted)

.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Sector)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(12,301 real changes made)

.         
. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(21,386 observations deleted)

.                 drop if CEOBoardMember == .
(457 observations deleted)

.                 
.         xtset FirmID FiscalYear
       panel variable:  FirmID (unbalanced)
        time variable:  FiscalYear, 2011 to 2020, but with gaps
                delta:  1 unit

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         save "D:\Master Thesis\202106_DataAnalysis\202106_EUS_dataset.xlsx", replace
file D:\Master Thesis\202106_DataAnalysis\202106_EUS_dataset.xlsx saved

. 
end of do-file

.         /**************************************************************************************************************
> ******\
>                 4.  Summary observation
>         \**************************************************************************************************************
> ******/
.                         do "D:\Master Thesis\202106_DataAnalysis\202106_DO_File\202106_4_SumObs.do"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Summary Observations
> \********************************************************************************************************************/
. 
. clear

. capture log close
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   2 Jul 2021, 16:10:34

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. **********************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a n
> egative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra acco
> unt to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a 
> contra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated In
> tangible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gr
> oss - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + 
> PrepaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm +
>  OtherLongTermAssetsTotal

.                         *CRER using total assets gross
.                                 gen CRER = CRE / TotalAssetGross

.                                 drop if CRER == 1
(4 observations deleted)

.                                 drop if CRER < 0.009
(4,638 observations deleted)

.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(4 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

.                         
.         /*****************\
>          Others variables
>         \*****************/
.         drop if Sector == "Academic & Educational Services"
(158 observations deleted)

.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Sector)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(12,301 real changes made)

.         
. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(21,386 observations deleted)

.                 drop if CEOBoardMember == .
(457 observations deleted)

.                 
.         xtset FirmID FiscalYear
       panel variable:  FirmID (unbalanced)
        time variable:  FiscalYear, 2011 to 2020, but with gaps
                delta:  1 unit

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         export excel using "D:\Master Thesis\202106_DataAnalysis\202106_EUS_dataset.xlsx", sheet("Data")replace firstro
> w(variables)
file D:\Master Thesis\202106_DataAnalysis\202106_EUS_dataset.xlsx saved

. 
end of do-file

. do "D:\Master Thesis\202106_DataAnalysis\202106_DO_File\202106_0_Master.do"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 01 June 2021
>   Description  : This is a master-do files of Grace's master thesis.
>                                  Included all process about the data.
> \********************************************************************************************************************/
. 
. clear

. capture log close
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   2 Jul 2021, 16:14:04

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. **********************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a n
> egative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra acco
> unt to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a 
> contra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated In
> tangible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gr
> oss - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + 
> PrepaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm +
>  OtherLongTermAssetsTotal

.                         *CRER using total assets gross
.                                 gen CRER = CRE / TotalAssetGross

.                                 drop if CRER == 1
(4 observations deleted)

.                                 drop if CRER < 0.009
(4,638 observations deleted)

.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(4 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

.                         
.         /*****************\
>          Others variables
>         \*****************/
.         drop if Sector == "Academic & Educational Services"
(158 observations deleted)

.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Sector)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(12,301 real changes made)

.         
. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(21,386 observations deleted)

.                 drop if CEOBoardMember == .
(457 observations deleted)

.                 
.         xtset FirmID FiscalYear
       panel variable:  FirmID (unbalanced)
        time variable:  FiscalYear, 2011 to 2020, but with gaps
                delta:  1 unit

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         export excel using "D:\Master Thesis\202106_DataAnalysis\202106_EUS_dataset.xlsx", sheet("Data")replace firstro
> w(variables)
file D:\Master Thesis\202106_DataAnalysis\202106_EUS_dataset.xlsx saved

. 
end of do-file

.         /**************************************************************************************************************
> ******\
>                 4.  Summary observation
>         \**************************************************************************************************************
> ******/
.                         do "D:\Master Thesis\202106_DataAnalysis\202106_DO_File\202106_4_SumObs.do"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Summary Observations
> \********************************************************************************************************************/
. 
. clear

. capture log close
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   2 Jul 2021, 16:18:13

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. **********************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a n
> egative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra acco
> unt to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a 
> contra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated In
> tangible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gr
> oss - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + 
> PrepaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm +
>  OtherLongTermAssetsTotal

.                         *CRER using total assets gross
.                                 gen CRER = CRE / TotalAssetGross

.                                 drop if CRER == 1
(4 observations deleted)

.                                 drop if CRER < 0.009
(4,638 observations deleted)

.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(4 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

.                         
.         /*****************\
>          Others variables
>         \*****************/
.         drop if Sector == "Academic & Educational Services"
(158 observations deleted)

.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Sector)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(12,301 real changes made)

.         
. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(21,386 observations deleted)

.                 drop if CEOBoardMember == .
(457 observations deleted)

.                 
.         xtset FirmID FiscalYear
       panel variable:  FirmID (unbalanced)
        time variable:  FiscalYear, 2011 to 2020, but with gaps
                delta:  1 unit

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         export excel using "D:\Master Thesis\202106_DataAnalysis\202106_EUS_dataset.xlsx", sheet("Data")replace firstro
> w(variables)
file D:\Master Thesis\202106_DataAnalysis\202106_EUS_dataset.xlsx saved

. 
end of do-file

. do "D:\Master Thesis\202106_DataAnalysis\202106_DO_File\202106_4_SumObs.do"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Summary Observations
> \********************************************************************************************************************/
. 
. clear

. capture log close
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   2 Jul 2021, 16:27:10

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. **********************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a n
> egative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra acco
> unt to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a 
> contra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated In
> tangible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gr
> oss - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + 
> PrepaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm +
>  OtherLongTermAssetsTotal

.                         *CRER using total assets gross
.                                 gen CRER = CRE / TotalAssetGross

.                                 drop if CRER == 1
(4 observations deleted)

.                                 drop if CRER < 0.009
(4,638 observations deleted)

.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(4 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

.                         
.         /*****************\
>          Others variables
>         \*****************/
.         drop if Sector == "Academic & Educational Services"
(158 observations deleted)

.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Sector)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID: gen NumFirm = _N

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(12,301 real changes made)

.         
. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(21,386 observations deleted)

.                 drop if CEOBoardMember == .
(457 observations deleted)

.                 
.         xtset FirmID FiscalYear
       panel variable:  FirmID (unbalanced)
        time variable:  FiscalYear, 2011 to 2020, but with gaps
                delta:  1 unit

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         export excel using "D:\Master Thesis\202106_DataAnalysis\202106_EUS_dataset.xlsx", sheet("Data")replace firstro
> w(variables)
file D:\Master Thesis\202106_DataAnalysis\202106_EUS_dataset.xlsx saved

. 
end of do-file

. order Identifier FirmID

. sort NumFirm

. order Identifier FirmID

. order Identifier FirmID NumFirm

. sort Identifier

. do "C:\Users\GL\AppData\Local\Temp\STDd34_000000.tmp"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Manage variables
>                                         - Label and rename existing variables
>                                         - Generate varibles and add Label use for regression
> \********************************************************************************************************************/
. 
. clear

. capture log close
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   2 Jul 2021, 16:44:12

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. **********************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a n
> egative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra acco
> unt to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a 
> contra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated In
> tangible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gr
> oss - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + 
> PrepaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm +
>  OtherLongTermAssetsTotal

.                         *CRER using total assets gross
.                                 gen CRER = CRE / TotalAssetGross

.                                 drop if CRER == 1
(4 observations deleted)

.                                 drop if CRER < 0.009
(4,638 observations deleted)

.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(4 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

.                         
.         /*****************\
>          Others variables
>         \*****************/
.         drop if Sector == "Academic & Educational Services"
(158 observations deleted)

.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Sector)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(12,301 real changes made)

.         
. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(21,386 observations deleted)

.                 drop if CEOBoardMember == .
(457 observations deleted)

.                 
.         xtset FirmID FiscalYear
       panel variable:  FirmID (unbalanced)
        time variable:  FiscalYear, 2011 to 2020, but with gaps
                delta:  1 unit

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         export excel using "D:\Master Thesis\202106_DataAnalysis\202106_EUS_dataset.xlsx", sheet("Data")replace firstro
> w(variables)
file D:\Master Thesis\202106_DataAnalysis\202106_EUS_dataset.xlsx saved

. 
end of do-file

. do "C:\Users\GL\AppData\Local\Temp\STDd34_000000.tmp"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Manage variables
>                                         - Label and rename existing variables
>                                         - Generate varibles and add Label use for regression
> \********************************************************************************************************************/
. 
. clear

. capture log close
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   2 Jul 2021, 16:45:32

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. **********************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a n
> egative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra acco
> unt to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a 
> contra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated In
> tangible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gr
> oss - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + 
> PrepaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm +
>  OtherLongTermAssetsTotal

.                         *CRER using total assets gross
.                                 gen CRER = CRE / TotalAssetGross

.                                 drop if CRER == 1
(4 observations deleted)

.                                 drop if CRER < 0.009
(4,638 observations deleted)

.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(4 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

.                         
.         /*****************\
>          Others variables
>         \*****************/
.         drop if Sector == "Academic & Educational Services"
(158 observations deleted)

.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Sector)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort Identifier: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(12,301 real changes made)

.         
. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(21,386 observations deleted)

.                 drop if CEOBoardMember == .
(457 observations deleted)

.                 
.         xtset FirmID FiscalYear
       panel variable:  FirmID (unbalanced)
        time variable:  FiscalYear, 2011 to 2020, but with gaps
                delta:  1 unit

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         export excel using "D:\Master Thesis\202106_DataAnalysis\202106_EUS_dataset.xlsx", sheet("Data")replace firstro
> w(variables)
file D:\Master Thesis\202106_DataAnalysis\202106_EUS_dataset.xlsx saved

. 
end of do-file

. do "C:\Users\GL\AppData\Local\Temp\STDd34_000000.tmp"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Manage variables
>                                         - Label and rename existing variables
>                                         - Generate varibles and add Label use for regression
> \********************************************************************************************************************/
. 
. clear

. capture log close
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   2 Jul 2021, 16:48:42

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. **********************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a n
> egative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra acco
> unt to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a 
> contra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated In
> tangible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gr
> oss - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + 
> PrepaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm +
>  OtherLongTermAssetsTotal

.                         *CRER using total assets gross
.                                 gen CRER = CRE / TotalAssetGross

.                                 drop if CRER == 1
(4 observations deleted)

.                                 drop if CRER < 0.009
(4,638 observations deleted)

.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(4 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

.                         
.         /*****************\
>          Others variables
>         \*****************/
.         drop if Sector == "Academic & Educational Services"
(158 observations deleted)

.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Indus)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(12,301 real changes made)

.         
. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(21,386 observations deleted)

.                 drop if CEOBoardMember == .
(457 observations deleted)

.                 
.         xtset FirmID FiscalYear
       panel variable:  FirmID (unbalanced)
        time variable:  FiscalYear, 2011 to 2020, but with gaps
                delta:  1 unit

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         export excel using "D:\Master Thesis\202106_DataAnalysis\202106_EUS_dataset.xlsx", sheet("Data")replace firstro
> w(variables)
file D:\Master Thesis\202106_DataAnalysis\202106_EUS_dataset.xlsx saved

. 
end of do-file

. do "C:\Users\GL\AppData\Local\Temp\STDd34_000000.tmp"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Manage variables
>                                         - Label and rename existing variables
>                                         - Generate varibles and add Label use for regression
> \********************************************************************************************************************/
. 
. clear

. capture log close
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   2 Jul 2021, 16:53:15

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. **********************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a n
> egative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra acco
> unt to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a 
> contra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated In
> tangible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gr
> oss - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + 
> PrepaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm +
>  OtherLongTermAssetsTotal

.                         *CRER using total assets gross
.                                 gen CRER = CRE / TotalAssetGross

.                                 drop if CRER == 1
(4 observations deleted)

.                                 drop if CRER < 0.009
(4,638 observations deleted)

.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(4 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

.                         
.         /*****************\
>          Others variables
>         \*****************/
.         drop if Sector == "Academic & Educational Services"
(158 observations deleted)

.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         bysort Identifier: gen FirmID = group(Identifier Name Indus)
IdentifierNameIndus not found
r(111);

end of do-file

r(111);

. do "C:\Users\GL\AppData\Local\Temp\STDd34_000000.tmp"

.                         bysort Identifier: egen FirmID = group(Identifier Name Indus)
egen ... group() may not be combined with by
r(190);

end of do-file

r(190);

. do "C:\Users\GL\AppData\Local\Temp\STDd34_000000.tmp"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Manage variables
>                                         - Label and rename existing variables
>                                         - Generate varibles and add Label use for regression
> \********************************************************************************************************************/
. 
. clear

. capture log close
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   2 Jul 2021, 16:55:03

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. **********************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a n
> egative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra acco
> unt to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a 
> contra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated In
> tangible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gr
> oss - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + 
> PrepaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm +
>  OtherLongTermAssetsTotal

.                         *CRER using total assets gross
.                                 gen CRER = CRE / TotalAssetGross

.                                 drop if CRER == 1
(4 observations deleted)

.                                 drop if CRER < 0.009
(4,638 observations deleted)

.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(4 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

.                         
.         /*****************\
>          Others variables
>         \*****************/
.         drop if Sector == "Academic & Educational Services"
(158 observations deleted)

.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier FiscalYear Name Indus)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(12,301 real changes made)

.         
. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(21,386 observations deleted)

.                 drop if CEOBoardMember == .
(457 observations deleted)

.                 
.         xtset FirmID FiscalYear
       panel variable:  FirmID (weakly balanced)
        time variable:  FiscalYear, 2011 to 2020
                delta:  1 unit

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         export excel using "D:\Master Thesis\202106_DataAnalysis\202106_EUS_dataset.xlsx", sheet("Data")replace firstro
> w(variables)
file D:\Master Thesis\202106_DataAnalysis\202106_EUS_dataset.xlsx saved

. 
end of do-file

. do "C:\Users\GL\AppData\Local\Temp\STDd34_000000.tmp"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Manage variables
>                                         - Label and rename existing variables
>                                         - Generate varibles and add Label use for regression
> \********************************************************************************************************************/
. 
. clear

. capture log close
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   2 Jul 2021, 16:56:51

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. **********************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a n
> egative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra acco
> unt to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a 
> contra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated In
> tangible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gr
> oss - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + 
> PrepaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm +
>  OtherLongTermAssetsTotal

.                         *CRER using total assets gross
.                                 gen CRER = CRE / TotalAssetGross

.                                 drop if CRER == 1
(4 observations deleted)

.                                 drop if CRER < 0.009
(4,638 observations deleted)

.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(4 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

.                         
.         /*****************\
>          Others variables
>         \*****************/
.         drop if Sector == "Academic & Educational Services"
(158 observations deleted)

.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Indus)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(12,301 real changes made)

.         
. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(21,386 observations deleted)

.                 drop if CEOBoardMember == .
(457 observations deleted)

.                 
.         xtset FirmID FiscalYear
       panel variable:  FirmID (unbalanced)
        time variable:  FiscalYear, 2011 to 2020, but with gaps
                delta:  1 unit

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         export excel using "D:\Master Thesis\202106_DataAnalysis\202106_EUS_dataset.xlsx", sheet("Data")replace firstro
> w(variables)
file D:\Master Thesis\202106_DataAnalysis\202106_EUS_dataset.xlsx saved

. 
end of do-file

. do "C:\Users\GL\AppData\Local\Temp\STDd34_000000.tmp"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Manage variables
>                                         - Label and rename existing variables
>                                         - Generate varibles and add Label use for regression
> \********************************************************************************************************************/
. 
. clear

. capture log close
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   2 Jul 2021, 16:58:09

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. **********************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a n
> egative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra acco
> unt to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a 
> contra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated In
> tangible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gr
> oss - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + 
> PrepaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm +
>  OtherLongTermAssetsTotal

.                         *CRER using total assets gross
.                                 gen CRER = CRE / TotalAssetGross

.                                 drop if CRER == 1
(4 observations deleted)

.                                 drop if CRER < 0.009
(4,638 observations deleted)

.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(4 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

.                         
.         /*****************\
>          Others variables
>         \*****************/
.         drop if Sector == "Academic & Educational Services"
(158 observations deleted)

.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Indus)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort Identifier Name Indus: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(12,301 real changes made)

.         
. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(21,386 observations deleted)

.                 drop if CEOBoardMember == .
(457 observations deleted)

.                 
.         xtset FirmID FiscalYear
       panel variable:  FirmID (unbalanced)
        time variable:  FiscalYear, 2011 to 2020, but with gaps
                delta:  1 unit

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         export excel using "D:\Master Thesis\202106_DataAnalysis\202106_EUS_dataset.xlsx", sheet("Data")replace firstro
> w(variables)
file D:\Master Thesis\202106_DataAnalysis\202106_EUS_dataset.xlsx saved

. 
end of do-file

. do "C:\Users\GL\AppData\Local\Temp\STDd34_000000.tmp"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Manage variables
>                                         - Label and rename existing variables
>                                         - Generate varibles and add Label use for regression
> \********************************************************************************************************************/
. 
. clear

. capture log close
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   2 Jul 2021, 17:00:38

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. **********************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a n
> egative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra acco
> unt to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a 
> contra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated In
> tangible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gr
> oss - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + 
> PrepaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm +
>  OtherLongTermAssetsTotal

.                         *CRER using total assets gross
.                                 gen CRER = CRE / TotalAssetGross

.                                 drop if CRER == 1
(4 observations deleted)

.                                 drop if CRER < 0.009
(4,638 observations deleted)

.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(4 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

.                 drop if Sector == "Academic & Educational Services"
(158 observations deleted)

.                 save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset1.dta", replace    
(note: file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset1.dta not found)
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset1.dta saved

.                 clear

. 
end of do-file

. do "C:\Users\GL\AppData\Local\Temp\STDd34_000000.tmp"

.                 use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset1.dta"

. 
end of do-file

. do "C:\Users\GL\AppData\Local\Temp\STDd34_000000.tmp"

.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Indus)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort Identifier Name Indus: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(12,301 real changes made)

. 
end of do-file

. do "C:\Users\GL\AppData\Local\Temp\STDd34_000000.tmp"

.                 clear

.         /*****************\
>          Others variables
>         \*****************/
.                 use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset1.dta"

.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Indus)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(12,301 real changes made)

. 
end of do-file

. do "C:\Users\GL\AppData\Local\Temp\STDd34_000000.tmp"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Manage variables
>                                         - Label and rename existing variables
>                                         - Generate varibles and add Label use for regression
> \********************************************************************************************************************/
. 
. clear

. capture log close
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   2 Jul 2021, 17:03:45

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. **********************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a n
> egative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra acco
> unt to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a 
> contra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated In
> tangible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gr
> oss - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + 
> PrepaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm +
>  OtherLongTermAssetsTotal

.                         *CRER using total assets gross
.                                 gen CRER = CRE / TotalAssetGross

.                                 drop if CRER == 1
(4 observations deleted)

.                                 drop if CRER < 0.009
(4,638 observations deleted)

.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(4 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(21,477 observations deleted)

.                 drop if CEOBoardMember == .
(457 observations deleted)

.                 drop if Sector == "Academic & Educational Services"
(67 observations deleted)

.                 save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset1.dta", replace    
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset1.dta saved

.                 clear

. 
end of do-file

. do "C:\Users\GL\AppData\Local\Temp\STDd34_000000.tmp"

.         /*****************\
>          Others variables
>         \*****************/
.                 use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset1.dta"

.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Indus)

. 
end of do-file

. do "C:\Users\GL\AppData\Local\Temp\STDd34_000000.tmp"

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID: gen NumFirm = _n

. 
end of do-file

. do "C:\Users\GL\AppData\Local\Temp\STDd34_000000.tmp"

.                 clear

.         /*****************\
>          Others variables
>         \*****************/
.                 use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset1.dta"

.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Indus)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID: gen NumFirm = _N

. 
end of do-file

. do "C:\Users\GL\AppData\Local\Temp\STDd34_000000.tmp"

.                 clear

.         /*****************\
>          Others variables
>         \*****************/
.                 use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset1.dta"

.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Indus)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID: gen NumFirm = _n

. 
end of do-file

. do "D:\Master Thesis\202106_DataAnalysis\202106_DO_File\202106_3_ManageVariables.do"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Manage variables
>                                         - Label and rename existing variables
>                                         - Generate varibles and add Label use for regression
> \********************************************************************************************************************/
. 
. clear

. capture log close
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   2 Jul 2021, 17:07:51

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. **********************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a n
> egative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra acco
> unt to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a 
> contra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated In
> tangible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gr
> oss - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + 
> PrepaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm +
>  OtherLongTermAssetsTotal

.                         *CRER using total assets gross
.                                 gen CRER = CRE / TotalAssetGross

.                                 drop if CRER == 1
(4 observations deleted)

.                                 drop if CRER < 0.009
(4,638 observations deleted)

.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(4 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(21,477 observations deleted)

.                 drop if CEOBoardMember == .
(457 observations deleted)

.                 drop if Sector == "Academic & Educational Services"
(67 observations deleted)

.                 save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset1.dta", replace    
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset1.dta saved

.                 clear

.         /*****************\
>          Others variables
>         \*****************/
.                 use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset1.dta"

.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Indus)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(3,112 real changes made)

.         xtset FirmID FiscalYear
       panel variable:  FirmID (unbalanced)
        time variable:  FiscalYear, 2011 to 2020, but with gaps
                delta:  1 unit

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         export excel using "D:\Master Thesis\202106_DataAnalysis\202106_EUS_dataset.xlsx", sheet("Data")replace firstro
> w(variables)
file D:\Master Thesis\202106_DataAnalysis\202106_EUS_dataset.xlsx saved

. 
end of do-file

. do "D:\Master Thesis\202106_DataAnalysis\202106_DO_File\202106_0_Master.do"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 01 June 2021
>   Description  : This is a master-do files of Grace's master thesis.
>                                  Included all process about the data.
> \********************************************************************************************************************/
. 
. clear

. capture log close
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   2 Jul 2021, 17:12:30

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. **********************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a n
> egative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra acco
> unt to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a 
> contra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated In
> tangible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gr
> oss - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + 
> PrepaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm +
>  OtherLongTermAssetsTotal

.                         *CRER using total assets gross
.                                 gen CRER = CRE / TotalAssetGross

.                                 drop if CRER == 1
(4 observations deleted)

.                                 drop if CRER < 0.009
(4,638 observations deleted)

.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(4 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(21,477 observations deleted)

.                 drop if CEOBoardMember == .
(457 observations deleted)

.                 drop if Sector == "Academic & Educational Services"
(67 observations deleted)

.                 save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset1.dta", replace    
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset1.dta saved

.                 clear

.         /*****************\
>          Others variables
>         \*****************/
.                 use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset1.dta"

.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Indus)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID FiscalYear: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(3,112 real changes made)

.         xtset FirmID FiscalYear
       panel variable:  FirmID (unbalanced)
        time variable:  FiscalYear, 2011 to 2020, but with gaps
                delta:  1 unit

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         export excel using "D:\Master Thesis\202106_DataAnalysis\202106_EUS_dataset.xlsx", sheet("Data")replace firstro
> w(variables)
file D:\Master Thesis\202106_DataAnalysis\202106_EUS_dataset.xlsx saved

. 
end of do-file

.         /**************************************************************************************************************
> ******\
>                 4.  Summary observation
>         \**************************************************************************************************************
> ******/
.                         do "D:\Master Thesis\202106_DataAnalysis\202106_DO_File\202106_4_SumObs.do"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Summary Observations
> \********************************************************************************************************************/
. 
. clear

. capture log close
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   2 Jul 2021, 17:24:44

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. **********************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a n
> egative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra acco
> unt to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a 
> contra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated In
> tangible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gr
> oss - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + 
> PrepaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm +
>  OtherLongTermAssetsTotal

.                         *CRER using total assets gross
.                                 gen CRER = CRE / TotalAssetGross

.                                 drop if CRER == 1
(4 observations deleted)

.                                 drop if CRER < 0.009
(4,638 observations deleted)

.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(4 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(21,477 observations deleted)

.                 drop if CEOBoardMember == .
(457 observations deleted)

.                 drop if Sector == "Academic & Educational Services"
(67 observations deleted)

.                 save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset1.dta", replace    
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset1.dta saved

.                 clear

.         /*****************\
>          Others variables
>         \*****************/
.                 use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset1.dta"

.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Indus)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID FiscalYear: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(3,112 real changes made)

.         xtset FirmID FiscalYear
       panel variable:  FirmID (unbalanced)
        time variable:  FiscalYear, 2011 to 2020, but with gaps
                delta:  1 unit

. 
end of do-file

. do "C:\Users\GL\AppData\Local\Temp\STDd34_000000.tmp"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Manage variables
>                                         - Label and rename existing variables
>                                         - Generate varibles and add Label use for regression
> \********************************************************************************************************************/
. 
. clear

. capture log close
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   2 Jul 2021, 17:25:20

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. **********************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a n
> egative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra acco
> unt to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a 
> contra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated In
> tangible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gr
> oss - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + 
> PrepaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm +
>  OtherLongTermAssetsTotal

.                         *CRER using total assets gross
.                                 gen CRER = CRE / TotalAssetGross

.                                 drop if CRER == 1
(4 observations deleted)

.                                 drop if CRER < 0.009
(4,638 observations deleted)

.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(4 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(21,477 observations deleted)

.                 drop if CEOBoardMember == .
(457 observations deleted)

.                 drop if Sector == "Academic & Educational Services"
(67 observations deleted)

.                 save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset1.dta", replace    
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset1.dta saved

.                 clear

.         /*****************\
>          Others variables
>         \*****************/
.                 use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset1.dta"

.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Indus)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(3,112 real changes made)

.         xtset FirmID FiscalYear
       panel variable:  FirmID (unbalanced)
        time variable:  FiscalYear, 2011 to 2020, but with gaps
                delta:  1 unit

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         export excel using "D:\Master Thesis\202106_DataAnalysis\202106_EUS_dataset.xlsx", sheet("Data")replace firstro
> w(variables)
file D:\Master Thesis\202106_DataAnalysis\202106_EUS_dataset.xlsx saved

. 
end of do-file

. do "D:\Master Thesis\202106_DataAnalysis\202106_DO_File\202106_4_SumObs.do"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Summary Observations
> \********************************************************************************************************************/
. 
. clear

. capture log close
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   2 Jul 2021, 17:28:26

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. **********************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a n
> egative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra acco
> unt to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a 
> contra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated In
> tangible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gr
> oss - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + 
> PrepaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm +
>  OtherLongTermAssetsTotal

.                         *CRER using total assets gross
.                                 gen CRER = CRE / TotalAssetGross

.                                 drop if CRER == 1
(4 observations deleted)

.                                 drop if CRER < 0.009
(4,638 observations deleted)

.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(4 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(21,477 observations deleted)

.                 drop if CEOBoardMember == .
(457 observations deleted)

.                 drop if Sector == "Academic & Educational Services"
(67 observations deleted)

.                 save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset1.dta", replace    
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset1.dta saved

.                 clear

.         /*****************\
>          Others variables
>         \*****************/
.                 use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset1.dta"

.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Indus)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(3,112 real changes made)

.         xtset FirmID FiscalYear
       panel variable:  FirmID (unbalanced)
        time variable:  FiscalYear, 2011 to 2020, but with gaps
                delta:  1 unit

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         export excel using "D:\Master Thesis\202106_DataAnalysis\202106_EUS_dataset.xlsx", sheet("Data")replace firstro
> w(variables)
file D:\Master Thesis\202106_DataAnalysis\202106_EUS_dataset.xlsx saved

. 
end of do-file

.         /**************************************************************************************************************
> ******\
>                 4.  Summary observation
>         \**************************************************************************************************************
> ******/
.                         do "D:\Master Thesis\202106_DataAnalysis\202106_DO_File\202106_4_SumObs.do"

. *This do-flies running under stata versions
. version 15.0

. 
. /********************************************************************************************************************\
>   Project Title: Grace's master thesis
>   Author       : Thanyapat W. [Grace]
>   Start Date   : 01 June 2021
>   Last Modified: 03 June 2021
>   Description  : Summary Observations
> \********************************************************************************************************************/
. 
. clear

. capture log close
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   3 Jul 2021, 01:27:47

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. **********************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a n
> egative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra acco
> unt to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a 
> contra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated In
> tangible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gr
> oss - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + 
> PrepaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm +
>  OtherLongTermAssetsTotal

.                         *CRER using total assets gross
.                                 gen CRER = CRE / TotalAssetGross

.                                 drop if CRER == 1
(4 observations deleted)

.                                 drop if CRER < 0.009
(4,638 observations deleted)

.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(4 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(21,477 observations deleted)

.                 drop if CEOBoardMember == .
(457 observations deleted)

.                 drop if Sector == "Academic & Educational Services"
(67 observations deleted)

.                 save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset1.dta", replace    
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset1.dta saved

.                 clear

.         /*****************\
>          Others variables
>         \*****************/
.                 use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset1.dta"

.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Indus)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(3,112 real changes made)

.         xtset FirmID FiscalYear
       panel variable:  FirmID (unbalanced)
        time variable:  FiscalYear, 2011 to 2020, but with gaps
                delta:  1 unit

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         export excel using "D:\Master Thesis\202106_DataAnalysis\202106_EUS_dataset.xlsx", sheet("Data")replace firstro
> w(variables)
file D:\Master Thesis\202106_DataAnalysis\202106_EUS_dataset.xlsx saved

.         export excel Identifier FiscalYear Name Country Sector CashShortTerm PPETotalGross BuildingGross LandGross Mach
> ineryGross ConstructionGross LeasesGross OtherPPEGross OtherPPENet PPETotalNet TotalAssets TotalDebt DeferredIncomeTaxL
> TLiability TotalLiabilities NetIncomeAfterTaxes CompanyMarketCap TotalEquity TotalDebtToTotalEquity BoardSize BoardAtte
> ndance BoardStructureType BoardBackgroundandSkills BoardGenderDiversity BoardSpecificSkills BoardMemberAffiliations Boa
> rdIndividualReelection BoardMemberMembershipLimits BoardMemberTermDuration BoardMemberCompensationUSD NumberofBoardMeet
> ings AverageBoardTenure NonExecutiveBoardMembers IndependentBoardMembers CEOBoardMember CEOChairmanSeparation CEOCompen
> sationLinktoTSR ChairmanisexCEO TobinQ CRE TotalAssetGross CRER FirmSize FirmLeverage Indus FirmID Region using "D:\To 
> George\Grace_dataset.xlsx", sheet("Data") sheetreplace firstrow(variables)
file D:\To George\Grace_dataset.xlsx saved

. 
end of do-file

. exit, clear
-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   3 Jul 2021, 01:39:47

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. **********************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a n
> egative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra acco
> unt to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a 
> contra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated In
> tangible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gr
> oss - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + 
> PrepaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm +
>  OtherLongTermAssetsTotal

.                         *CRER using total assets gross
.                                 gen CRER = CRE / TotalAssetGross

.                                 drop if CRER == 1
(4 observations deleted)

.                                 drop if CRER < 0.009
(4,638 observations deleted)

.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(4 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(21,477 observations deleted)

.                 drop if CEOBoardMember == .
(457 observations deleted)

.                 drop if Sector == "Academic & Educational Services"
(67 observations deleted)

.                 save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset1.dta", replace    
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset1.dta saved

.                 clear

.         /*****************\
>          Others variables
>         \*****************/
.                 use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset1.dta"

.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Indus)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(3,112 real changes made)

.         xtset FirmID FiscalYear
       panel variable:  FirmID (unbalanced)
        time variable:  FiscalYear, 2011 to 2020, but with gaps
                delta:  1 unit

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         export excel using "D:\Master Thesis\202106_DataAnalysis\202106_EUS_dataset.xlsx", sheet("Data")replace firstro
> w(variables)
file D:\Master Thesis\202106_DataAnalysis\202106_EUS_dataset.xlsx saved

.         export excel Identifier FiscalYear Name Country Sector CashShortTerm PPETotalGross BuildingGross LandGross Mach
> ineryGross ConstructionGross LeasesGross OtherPPEGross OtherPPENet PPETotalNet TotalAssets TotalDebt DeferredIncomeTaxL
> TLiability TotalLiabilities NetIncomeAfterTaxes CompanyMarketCap TotalEquity TotalDebtToTotalEquity BoardSize BoardAtte
> ndance BoardStructureType BoardBackgroundandSkills BoardGenderDiversity BoardSpecificSkills BoardMemberAffiliations Boa
> rdIndividualReelection BoardMemberMembershipLimits BoardMemberTermDuration BoardMemberCompensationUSD NumberofBoardMeet
> ings AverageBoardTenure NonExecutiveBoardMembers IndependentBoardMembers CEOBoardMember CEOChairmanSeparation CEOCompen
> sationLinktoTSR ChairmanisexCEO TobinQ CRE TotalAssetGross CRER FirmSize FirmLeverage Indus FirmID Region using "D:\To 
> George\Grace_dataset.xlsx", sheet("Data") sheetreplace firstrow(variables)
file D:\To George\Grace_dataset.xlsx saved

. 
end of do-file

-------------------------------------------------------------------------------------------------------------------------
      name:  <unnamed>
       log:  D:\Master Thesis\202106_DataAnalysis\202106_LOG_File\202106_3_ManageVariables.log
  log type:  text
 opened on:   3 Jul 2021, 01:43:13

. *cmdlog: saves every command used in stata.
.         cmdlog using "D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log", append
(cmdlog D:\Master Thesis\202106_DataAnalysis\202106_LOGCMD_File\202106_3_ManageVariablescmd.log opened)

. **********************************************************************************************************************
. 
. /***********************************************************************************************************\
>  Now I am going to import the dataset: 202106_EUS
>  Then I will rename and label to the variables that already exist
> \***********************************************************************************************************/
.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS.dta"

.         
.         /**********************************\
>           Label and rename Exist variables      
>         \**********************************/    
.                 label variable Identifier "Identifier (RIC)"

.                 label variable FiscalYear "Fiscal Year"

.                 label variable Name "Company Name"

.                 label variable Country "Country of Headquarters"

.                 label variable Sector "TRBC Economic Sector Name"

.                 label variable CashShortTerm "Cash and Short Term Investments"

.                 label variable ARNet "Accounts Receivable - Trade, Net"

.                 label variable ARGross "Accounts Receivable - Trade, Gross"

.                 label variable PDA "Provision for Doubtful Accounts"

.                 label variable TotalReceivablesNet "Total Receivables, Net"

.                 label variable TotalInventory "Total Inventory"

.                 label variable PrepaidExpenses "Prepaid Expenses"

.                 label variable OtherCurrentAssetsTotal "Other Current Assets, Total"

.                 label variable PPETotalGross "Property, Plant And Equipment, Total - Gross"

.                 label variable BuildingGross "Building - Gross"

.                 label variable LandGross "Land/Improvements - Gross"

.                 label variable MachineryGross "Machinery/Equipment - Gross"

.                 label variable ConstructionGross "Construction in Progress - Gross"

.                 label variable LeasesGross "Leases - Gross"

.                 label variable OtherPPEGross "Other Property/Plant/Equipment - Gross"

.                 label variable OtherPPENet "Other Property, Plant, Equipment - Net"

.                 label variable PPETotalNet "Property, Plant And Equipment, Total - Net"

.                 label variable ADTotal "Accumulated Depreciation, Total"

.                 label variable GoodwillNet "Goodwill, Net"

.                 label variable GoodwillGross "Goodwill - Gross"

.                 label variable AccuGoodwillAmortization "Accumulated Goodwill Amortization"

.                 label variable IntangiblesNet "Intangibles, Net"

.                 label variable IntangiblesGross "Intangibles, Gross"

.                 label variable AccuIntangibleAmortization "Accumulated Intangible Amortization"

.                 label variable NoteReceivableLongTerm "Note Receivable - Long Term"

.                 label variable OtherLongTermAssetsTotal "Other Long Term Assets, Total"

.                 label variable TotalAssetsReported "Total Assets, Reported"

.                 rename TotalAssetsReported TotalAssets

.                 label variable TotalDebt "Total Debt"

.                 label variable DeferredIncomeTaxLTLiability "Deferred Income Tax - LT Liability"

.                 label variable TotalLiabilities "Total Liabilities"

.                 label variable NetIncomeAfterTaxes "Net Income After Taxes"

.                 label variable BookValuePershare "Book Value Per Share"

.                 label variable BookValuePershareTotalEquity "Book Value Per Share, Total Equity"

.                 label variable CompanyMarketCap "Company Market Cap"

.                 label variable TotalEquity "Total Equity"

.                 label variable TotalDebtToTotalEquity "Total Debt to Total Equity"

.                 label variable BoardSize "Board Size"

.                 label variable BoardAttendance "Board Attendance"

.                 label variable BoardStructureType "Board Structure Type"

.                 label variable BoardBackgroundandSkills "Board Background and Skills"

.                 label variable BoardGenderDiversityPercent "Board Gender Diversity"

.                 rename BoardGenderDiversityPercent BoardGenderDiversity

.                 label variable BoardSpecificSkillsPercent "Board Specific Skills"

.                 rename BoardSpecificSkillsPercent BoardSpecificSkills

.                 label variable BoardMemberAffiliations "Board Member Affiliations"

.                 label variable BoardIndividualReelection "Board Individual Re-election"

.                 label variable BoardMemberMembershipLimits "Board Member Membership Limits"

.                 label variable BoardMemberTermDuration "Board Member Term Duration"

.                 label variable BoardMemberCompensationUSD "Board Member Compensation"

.                 label variable FemaleonBoard "Female on Board"

.                 label variable NumberofBoardMeetings "Number of Board Meetings"

.                 label variable AverageBoardTenure "Average Board Tenure"

.                 label variable NonExecutiveBoardMembers "Non-Executive Board Members"

.                 label variable IndependentBoardMembers "Independent Board Members"

.                 label variable CEOBoardMember "1 = The CEO is a board member"

.                 label variable CEOChairmanSeparation "1 = CEO is the chairman"

.                 label variable CEOCompensationLinktoTSR "1 = the CEO's compensation linked to total shareholder return 
> (TSR)"

.                 label variable ChairmanisexCEO "1 =  Chairman was CEO in previous years"

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         clear

. /***********************************************************************************************************\
>  Next I will create new variables use for regression
> \***********************************************************************************************************/
.         clear

.         use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta"

.         *Before I go further I will check missing value in each variables and consider to replace some with 0 or drop b
> y using
.                 mdesc

    Variable    |     Missing          Total     Percent Missing
----------------+-----------------------------------------------
     Identifier |           0        150,040           0.00
     FiscalYear |           0        150,040           0.00
           Name |           0        150,040           0.00
        Country |           0        150,040           0.00
         Sector |           0        150,040           0.00
   CashShortT~m |      59,738        150,040          39.81
          ARNet |      74,795        150,040          49.85
        ARGross |     111,324        150,040          74.20
            PDA |     111,134        150,040          74.07
   TotalRecei~t |      68,673        150,040          45.77
   TotalInven~y |      91,932        150,040          61.27
   PrepaidExp~s |      89,033        150,040          59.34
   OtherCurre~l |     101,361        150,040          67.56
   PPETotalGr~s |      82,974        150,040          55.30
   BuildingGr~s |     110,712        150,040          73.79
      LandGross |     112,771        150,040          75.16
   MachineryG~s |      95,600        150,040          63.72
   Constructi~s |     121,077        150,040          80.70
    LeasesGross |     148,691        150,040          99.10
   OtherPPEGr~s |     100,583        150,040          67.04
    OtherPPENet |     119,693        150,040          79.77
    PPETotalNet |      60,816        150,040          40.53
        ADTotal |      83,853        150,040          55.89
    GoodwillNet |     102,161        150,040          68.09
   GoodwillGr~s |     137,098        150,040          91.37
   AccuGoodwi~n |     137,382        150,040          91.56
   Intangible~t |      81,641        150,040          54.41
   Intangible~s |     104,086        150,040          69.37
   AccuIntang~n |     104,657        150,040          69.75
   NoteReceiv~m |     124,969        150,040          83.29
   OtherLongT~l |      76,440        150,040          50.95
    TotalAssets |      50,177        150,040          33.44
      TotalDebt |      50,758        150,040          33.83
   DeferredIn~y |     106,033        150,040          70.67
   TotalLiabi~s |      50,600        150,040          33.72
   NetIncomeA~s |      49,708        150,040          33.13
   BookValueP~e |      52,200        150,040          34.79
   BookValueP~y |      51,117        150,040          34.07
   CompanyMar~p |      37,029        150,040          24.68
    TotalEquity |      50,234        150,040          33.48
   TotalDebtT~y |      66,047        150,040          44.02
      BoardSize |     129,794        150,040          86.51
   BoardAtten~e |     129,770        150,040          86.49
   BoardStruc~e |     129,927        150,040          86.59
   BoardBackg~s |     129,770        150,040          86.49
   BoardGende~y |     129,797        150,040          86.51
   BoardSpeci~s |     130,433        150,040          86.93
   BoardMemb~ns |     129,805        150,040          86.51
   BoardIndiv~n |     129,770        150,040          86.49
   BoardMemb~ts |     131,910        150,040          87.92
   BoardMembe~n |     130,220        150,040          86.79
   BoardMembe~D |     130,850        150,040          87.21
   FemaleonBo~d |     129,797        150,040          86.51
   NumberofBo~s |     131,276        150,040          87.49
   AverageBoa~e |     130,132        150,040          86.73
   NonExecuti~s |     129,798        150,040          86.51
   Independen~s |     129,811        150,040          86.52
   CEOBoardMe~r |     130,655        150,040          87.08
   CEOChairma~n |     129,770        150,040          86.49
   CEOCompens~R |     129,769        150,040          86.49
   Chairmanis~O |     129,769        150,040          86.49
----------------+-----------------------------------------------

.                 
.         /************\
>           Drop Value
>         \************/
.                 *Due to the definition define in Datastream
.                 *Provision for Doubtful Accounts is established as a contra account to receivables and expressed in a n
> egative figure
.                         keep if PDA < 0 | PDA == .
(1,436 observations deleted)

.                 *Accumulated Depreciation, Total: Due to the nature of Accumulated Depreciation, Total as a contra acco
> unt to assets, it is always a negative figure.
.                         keep if ADTotal < 0 | ADTotal == .
(483 observations deleted)

.                 *Accumulated Goodwill Amortization: Due to the nature of Accumulated Goodwill Amortization [AAGA] as a 
> contra account to assets, it is always a negative figure. 
.                         keep if AccuGoodwillAmortization < 0 | AccuGoodwillAmortization == .
(3,830 observations deleted)

.                 *Due to the nature of Accumulated Intangible Amortization as a contra account to assets, Accumulated In
> tangible Amortization [AAMT] is always a negative figure.
.                         keep if AccuIntangibleAmortization < 0 | AccuIntangibleAmortization == .
(352 observations deleted)

.         
.         /*******************\
>          Dependent Variables
>         \*******************/
.                 *Note that book value of equity = TotalEquity
.                 *1.The main dependent variable is Tobin's Q
.                         *After running, I found that STATA will not calculate missing value
.                                 *ref. https://stats.idre.ucla.edu/stata/modules/missing-values/
.                                 *"Whenever you add, subtract, multiply, divide, etc., values that involve missing a mis
> sing value, the result is missing."
.                         *Therefore, I will ged rid off missing value by drop or replace it with "0"
.                                 *Since Total assets should not equal to "0" or . 
.                                 *Therefore, I will drop if TotalAssets == . | TotalAssets == 0 to avoid error (Total as
> set use as Denominator in many equation)
.                                         drop if TotalAssets == . | TotalAssets == 0
(51,034 observations deleted)

.                                 *Drop MarketCap if CompanyMarketCap == . 
.                                         drop if CompanyMarketCap == . | CompanyMarketCap == 0
(8,949 observations deleted)

.                                 *Drop TotalEquity if TotalEquity == . | TotalEquity == 0 to avoid error (Total equity u
> se as denominator in MB and Leverage)
.                                         drop if TotalEquity == . | TotalEquity == 0
(166 observations deleted)

.                                 *I will replace DeferredTax with 0 since DeferredTaxcan be 0
.                                         replace DeferredIncomeTaxLTLiability = 0 if missing(DeferredIncomeTaxLTLiabilit
> y)
(46,146 real changes made)

.                         gen TobinQ = (TotalAssets + CompanyMarketCap - TotalEquity - DeferredIncomeTaxLTLiability) / To
> talAssets

.                 *2.For sensitivity check I will use M/B ratio
.                         gen MB = CompanyMarketCap / TotalEquity

.         /*******************\
>          Inpendent Variables
>         \*******************/
.                 *1.Corporate Real Estate Ratio: CRER
.                         drop if PPETotalNet == . | PPETotalNet > TotalAssets
(7,864 observations deleted)

.                         drop if PPETotalGross == . | PPETotalGross > TotalAssets
(26,373 observations deleted)

.                         *Same as above I will replace "0" for all CRE varibles
.                                 replace BuildingGross = 0 if missing(BuildingGross)
(19,082 real changes made)

.                                 replace LandGross = 0 if missing(LandGross)
(21,715 real changes made)

.                                 replace MachineryGross = 0 if missing(MachineryGross)
(9,481 real changes made)

.                                 replace ConstructionGross = 0 if missing(ConstructionGross)
(28,980 real changes made)

.                                 replace LeasesGross = 0 if missing(LeasesGross)
(48,501 real changes made)

.                                 replace OtherPPEGross = 0 if missing(OtherPPEGross)
(13,333 real changes made)

.                                 replace ADTotal = 0 if missing(ADTotal)
(917 real changes made)

.                                 *gen CRE = PPE_Total_Net_check - Equipment_Gross - NaturalResources_Gross - OtherPPE_Gr
> oss - AccDepreciation_Total 
.                                 gen CRE = BuildingGross + LandGross + ConstructionGross

.                                 drop if CRE <=0
(10,026 observations deleted)

.                                 drop if CRE > TotalAssets
(0 observations deleted)

.                         *Generate Total assets gross
.                                 replace CashShortTerm = 0 if missing(CashShortTerm)
(4,794 real changes made)

.                                 replace ARGross = 0 if missing(ARGross)
(15,781 real changes made)

.                                 replace TotalReceivablesNet = 0 if missing(TotalReceivablesNet)
(5,722 real changes made)

.                                 replace TotalInventory = 0 if missing(TotalInventory)
(12,240 real changes made)

.                                 replace PrepaidExpenses = 0 if missing(PrepaidExpenses)
(13,583 real changes made)

.                                 replace OtherCurrentAssetsTotal = 0 if missing(OtherCurrentAssetsTotal)
(15,793 real changes made)

.                                 replace PPETotalGross = 0 if missing(PPETotalGross)
(0 real changes made)

.                                 replace GoodwillGross = 0 if missing(GoodwillGross)
(33,304 real changes made)

.                                 replace IntangiblesGross = 0 if missing(IntangiblesGross)
(11,326 real changes made)

.                                 replace NoteReceivableLongTerm = 0 if missing(NoteReceivableLongTerm)
(29,073 real changes made)

.                                 replace OtherLongTermAssetsTotal = 0 if missing(OtherLongTermAssetsTotal)
(4,652 real changes made)

.                                 gen TotalAssetGross = CashShortTerm + ARGross + TotalReceivablesNet + TotalInventory + 
> PrepaidExpenses + OtherCurrentAssetsTotal + PPETotalGross + GoodwillGross + IntangiblesGross + NoteReceivableLongTerm +
>  OtherLongTermAssetsTotal

.                         *CRER using total assets gross
.                                 gen CRER = CRE / TotalAssetGross

.                                 drop if CRER == 1
(4 observations deleted)

.                                 drop if CRER < 0.009
(4,638 observations deleted)

.         /*****************\
>          Control Variables
>         \*****************/
.                 *1.Control for firm size
.                         gen FirmSize = log(TotalAssets)

.                 *2.Control for firm leverage
.                         *I will drop missing TotalDebt
.                                 drop if TotalDebt == .
(10 observations deleted)

.                         gen FirmLeverage = TotalDebt/TotalEquity

.                 *3.Control for ROA
.                         *I will drop missing NetIncome
.                                 drop if NetIncome == .
(4 observations deleted)

.                         *Then I will generate new ROA
.                         gen ROA = NetIncome/TotalAssets

. /***********************************************************************************************************\
>  Drop variables
> \***********************************************************************************************************/
.         /****************\
>          Board variables
>         \****************/
.                 drop if ChairmanisexCEO == .
(21,477 observations deleted)

.                 drop if CEOBoardMember == .
(457 observations deleted)

.                 drop if Sector == "Academic & Educational Services"
(67 observations deleted)

.                 save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset1.dta", replace    
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset1.dta saved

.                 clear

.         /*****************\
>          Others variables
>         \*****************/
.                 use "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset1.dta"

.                 *Create sector of industries as int by change sector from string to int
.                         egen Indus = group(Sector)

.                 *Create Unique FirmID as int by change FirmID from String int
.                         egen FirmID = group(Identifier Name Indus)

.                 *Create NumFirm to measure how many firm in each industries
.                         *use _n to see how many data of that firm in each year
.                         bysort FirmID: gen NumFirm = _n

.                 *Create region dummy
.                         gen Region = 0

.                         replace Region = 1 if Country != "United States of America"
(3,112 real changes made)

.         xtset FirmID FiscalYear
       panel variable:  FirmID (unbalanced)
        time variable:  FiscalYear, 2011 to 2020, but with gaps
                delta:  1 unit

.         save "D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta", replace
file D:\Master Thesis\202106_DataAnalysis\202106_DTA_File\202106_EUS_dataset.dta saved

.         export excel using "D:\Master Thesis\202106_DataAnalysis\202106_EUS_dataset.xlsx", sheet("Data")replace firstro
> w(variables)
file D:\Master Thesis\202106_DataAnalysis\202106_EUS_dataset.xlsx saved

. *       export excel Identifier FiscalYear Name Country Sector CashShortTerm PPETotalGross BuildingGross LandGross Mach
> ineryGross ConstructionGross LeasesGross OtherPPEGross OtherPPENet PPETotalNet TotalAssets TotalDebt DeferredIncomeTaxL
> TLiability TotalLiabilities NetIncomeAfterTaxes CompanyMarketCap TotalEquity TotalDebtToTotalEquity BoardSize BoardAtte
> ndance BoardStructureType BoardBackgroundandSkills BoardGenderDiversity BoardSpecificSkills BoardMemberAffiliations Boa
> rdIndividualReelection BoardMemberMembershipLimits BoardMemberTermDuration BoardMemberCompensationUSD NumberofBoardMeet
> ings AverageBoardTenure NonExecutiveBoardMembers IndependentBoardMembers CEOBoardMember CEOChairmanSeparation CEOCompen
> sationLinktoTSR ChairmanisexCEO TobinQ CRE TotalAssetGross CRER FirmSize FirmLeverage Indus FirmID Region using "D:\To 
> George\Grace_dataset.xlsx", sheet("Data") sheetreplace firstrow(variables)
. 
end of do-file

. exit, clear
. exit, clear
